<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Chris的博客</title>
  
  <subtitle>前端路漫漫</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://chrischen0405.github.io/"/>
  <updated>2022-09-23T02:37:00.166Z</updated>
  <id>http://chrischen0405.github.io/</id>
  
  <author>
    <name>陈文杰</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>npm安装卸载指令</title>
    <link href="http://chrischen0405.github.io/2022/07/11/post20220711/"/>
    <id>http://chrischen0405.github.io/2022/07/11/post20220711/</id>
    <published>2022-07-11T06:05:32.000Z</published>
    <updated>2022-09-23T02:37:00.166Z</updated>
    
    <content type="html"><![CDATA[<h2 id="npm安装模块"><a href="#npm安装模块" class="headerlink" title="npm安装模块"></a>npm安装模块</h2><ul><li><code>npm install xxx</code> 安装xxx模块到当前命令行所在目录</li><li><code>npm install xxx -g</code> 全局安装xxx模块</li></ul><a id="more"></a><p>本地安装把模块写入 package.json 中：</p><ul><li><code>npm install xxx</code> 安装xxx模块不写入 package.json</li><li><code>npm install xxx -save</code> 安装xxx模块并且写入 package.json 的 <code>dependencies</code> 中</li><li><code>npm install xxx -save-dev</code> 安装xxx模块并写入 package.json 的 <code>devDependencies</code> 中</li></ul><h2 id="npm卸载模块"><a href="#npm卸载模块" class="headerlink" title="npm卸载模块"></a>npm卸载模块</h2><ul><li><code>npm uninstall xxx</code> 卸载xxx模块</li><li><code>npm uninstall xxx -g</code> 全局卸载xxx模块</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;npm安装模块&quot;&gt;&lt;a href=&quot;#npm安装模块&quot; class=&quot;headerlink&quot; title=&quot;npm安装模块&quot;&gt;&lt;/a&gt;npm安装模块&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;npm install xxx&lt;/code&gt; 安装xxx模块到当前命令行所在目录&lt;/li&gt;
&lt;li&gt;&lt;code&gt;npm install xxx -g&lt;/code&gt; 全局安装xxx模块&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="node" scheme="http://chrischen0405.github.io/categories/node/"/>
    
    
      <category term="npm" scheme="http://chrischen0405.github.io/tags/npm/"/>
    
      <category term="node" scheme="http://chrischen0405.github.io/tags/node/"/>
    
      <category term="指令" scheme="http://chrischen0405.github.io/tags/%E6%8C%87%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>VUE-CLI3+PX2REM-LOADER+SCSS移动端自适应配置</title>
    <link href="http://chrischen0405.github.io/2022/07/06/post20220706/"/>
    <id>http://chrischen0405.github.io/2022/07/06/post20220706/</id>
    <published>2022-07-06T08:38:31.000Z</published>
    <updated>2022-09-23T02:33:22.585Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-前言"><a href="#1-前言" class="headerlink" title="1 前言"></a>1 前言</h2><p>移动端自适应需要做适配，本文介绍vue-cli3+px2rem-loader+scss的配置</p><a id="more"></a><h2 id="2-安装"><a href="#2-安装" class="headerlink" title="2 安装"></a>2 安装</h2><blockquote><p><strong>amfe-flexible</strong>：根据设备宽度，修改根元素html的大小，以适配不一样终端<br><strong>px2rem-loader</strong>：将css中的px转为rem单位，用了它就不用本身计算rem值了</p></blockquote><p><strong>注意</strong>：amfe-flexible是lib-flexible的优化，主要区别是amfe-flexible不会改变视口大小</p><p>安装amfe-flexible和px2rem-loader:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install amfe-flexible -save</span><br><span class="line">npm install px2rem-loader -save-dev</span><br></pre></td></tr></table></figure><h2 id="3-配置amfe-flexible"><a href="#3-配置amfe-flexible" class="headerlink" title="3 配置amfe-flexible"></a>3 配置amfe-flexible</h2><p>在入口文件main.js文件中引入amfe-flexible：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'amfe-flexible/index.js'</span></span><br></pre></td></tr></table></figure><p>在index.html中修改meta：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>amfe-flexible干了什么呢？</p><ul><li>给元素动态改写font-size的值</li><li>设置1rem = viewWidth / 10</li><li>设置页面刷新时重置rem</li><li>支持0.5px</li></ul></blockquote><h3 id="4-配置px2rem-loader"><a href="#4-配置px2rem-loader" class="headerlink" title="4 配置px2rem-loader"></a>4 配置px2rem-loader</h3><p>在vue.config.js中配置：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    config.module</span><br><span class="line">      .rule(<span class="string">'scss'</span>)</span><br><span class="line">      .test(<span class="regexp">/\.scss$/</span>)</span><br><span class="line">      .oneOf(<span class="string">'vue'</span>)</span><br><span class="line">      .use(<span class="string">'px2rem'</span>)</span><br><span class="line">      .loader(<span class="string">'px2rem-loader'</span>)</span><br><span class="line">      .before(<span class="string">'postcss-loader'</span>)</span><br><span class="line">      .options(&#123;</span><br><span class="line">        remUnit: <span class="number">75</span> <span class="comment">// 设计稿的宽度的1/10</span></span><br><span class="line">      &#125;).end()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后重启脚手架</p><h2 id="5-参考文章"><a href="#5-参考文章" class="headerlink" title="5 参考文章"></a>5 参考文章</h2><p><a href="http://www.javashuo.com/article/p-dqkawmqf-g.html" target="_blank" rel="noopener">《vue移动端h5适配解决方案（rem or vw）》</a><br><a href="https://blog.csdn.net/josiecici/article/details/109336620" target="_blank" rel="noopener">《vue-cli3+lib-flexible+postcss-px2rem+less》</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-前言&quot;&gt;&lt;a href=&quot;#1-前言&quot; class=&quot;headerlink&quot; title=&quot;1 前言&quot;&gt;&lt;/a&gt;1 前言&lt;/h2&gt;&lt;p&gt;移动端自适应需要做适配，本文介绍vue-cli3+px2rem-loader+scss的配置&lt;/p&gt;
    
    </summary>
    
      <category term="Vue" scheme="http://chrischen0405.github.io/categories/Vue/"/>
    
    
      <category term="Vue" scheme="http://chrischen0405.github.io/tags/Vue/"/>
    
      <category term="PX2REM-LOADER" scheme="http://chrischen0405.github.io/tags/PX2REM-LOADER/"/>
    
      <category term="scss" scheme="http://chrischen0405.github.io/tags/scss/"/>
    
      <category term="移动端" scheme="http://chrischen0405.github.io/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"/>
    
      <category term="自适应" scheme="http://chrischen0405.github.io/tags/%E8%87%AA%E9%80%82%E5%BA%94/"/>
    
  </entry>
  
  <entry>
    <title>ecahrts雷达图tooltip显示axis单轴数据</title>
    <link href="http://chrischen0405.github.io/2022/05/26/post20220526/"/>
    <id>http://chrischen0405.github.io/2022/05/26/post20220526/</id>
    <published>2022-05-26T10:25:41.000Z</published>
    <updated>2022-09-23T02:30:53.149Z</updated>
    
    <content type="html"><![CDATA[<h3 id="1、遇到问题"><a href="#1、遇到问题" class="headerlink" title="1、遇到问题"></a>1、遇到问题</h3><p>在echarts雷达图中将<code>tooltip.trigger</code>设置为<code>axis</code>时失效，雷达图并不会显示单轴数据，而是整个雷达图的数据</p><a id="more"></a><p><img src="https://upload-images.jianshu.io/upload_images/13924215-bc93503eac6a11ae.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tooltip.trigger"></p><h3 id="2、实现效果"><a href="#2、实现效果" class="headerlink" title="2、实现效果"></a>2、实现效果</h3><p>先贴出我们想要的效果，和折线图柱状图类似的，希望可以在一个轴线上能显示雷达图在这个轴线维度上的数据：</p><p><img src="https://upload-images.jianshu.io/upload_images/13924215-378f08d2a081c56b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="实现效果"></p><h3 id="3、源码"><a href="#3、源码" class="headerlink" title="3、源码"></a>3、源码</h3><p>可以直接在echarts官网运行查看效果的代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dataList = [</span><br><span class="line">    &#123;</span><br><span class="line">        name: <span class="string">'小明'</span>,</span><br><span class="line">        data: [<span class="number">54</span>, <span class="number">32</span>, <span class="number">56</span>, <span class="number">30</span>, <span class="number">95</span>, <span class="number">35</span>],</span><br><span class="line">        color: <span class="string">'#5470c6'</span>,</span><br><span class="line">        unit: <span class="string">'分'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        name: <span class="string">'小红'</span>,</span><br><span class="line">        data: [<span class="number">84</span>, <span class="number">63</span>, <span class="number">23</span>, <span class="number">59</span>, <span class="number">78</span>, <span class="number">95</span>],</span><br><span class="line">        color: <span class="string">'#91cc75'</span>,</span><br><span class="line">        unit: <span class="string">'分'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        name: <span class="string">'小刚'</span>,</span><br><span class="line">        data: [<span class="number">14</span>, <span class="number">98</span>, <span class="number">63</span>, <span class="number">74</span>, <span class="number">40</span>, <span class="number">67</span>],</span><br><span class="line">        color: <span class="string">'#fac858'</span>,</span><br><span class="line">        unit: <span class="string">'分'</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> indicator = [</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">'语文'</span>, <span class="attr">max</span>: <span class="number">100</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">'数学'</span>, <span class="attr">max</span>: <span class="number">100</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">'英语'</span>, <span class="attr">max</span>: <span class="number">100</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">'物理'</span>, <span class="attr">max</span>: <span class="number">100</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">'化学'</span>, <span class="attr">max</span>: <span class="number">100</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">'生物'</span>, <span class="attr">max</span>: <span class="number">100</span> &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> buildSeries = <span class="function"><span class="keyword">function</span> (<span class="params">dataIndex</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> data = dataList[dataIndex].data</span><br><span class="line">    <span class="keyword">const</span> helper = data.map(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>(data.length)</span><br><span class="line">        arr.splice(index, <span class="number">1</span>, item)</span><br><span class="line">        <span class="keyword">return</span> arr</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> [data, ...helper].map(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            name: dataList[dataIndex].name,</span><br><span class="line">            type: <span class="string">'radar'</span>,</span><br><span class="line">            symbol: index === <span class="number">0</span> ? <span class="string">'circle'</span> : <span class="string">'none'</span>,</span><br><span class="line">            symbolSize: <span class="number">4</span>,</span><br><span class="line">            itemStyle: &#123;</span><br><span class="line">                color: <span class="string">'#fff'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            lineStyle: &#123;</span><br><span class="line">                color: index === <span class="number">0</span> ? dataList[dataIndex].color : <span class="string">'transparent'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            areaStyle: &#123;</span><br><span class="line">                color: index === <span class="number">0</span> ? dataList[dataIndex].color : <span class="string">'transparent'</span>,</span><br><span class="line">                opacity: <span class="number">0.5</span></span><br><span class="line">            &#125;,</span><br><span class="line">            tooltip: &#123;</span><br><span class="line">                show: index === <span class="number">0</span> ? <span class="literal">false</span> : <span class="literal">true</span>,</span><br><span class="line">                formatter: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">let</span> res = indicator[index - <span class="number">1</span>].name + <span class="string">'：&lt;br&gt;'</span></span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> dataList) &#123;</span><br><span class="line">                        <span class="keyword">let</span> str = <span class="string">'&lt;i style="display: inline-block;width: 10px;height: 10px;background: '</span> +</span><br><span class="line">                            x.color + <span class="string">';margin-right: 5px;border-radius: 50%;&#125;"&gt;&lt;/i&gt;'</span> +</span><br><span class="line">                            x.name + <span class="string">'：'</span> + x.data[index - <span class="number">1</span>] + x.unit + <span class="string">'&lt;br&gt;'</span></span><br><span class="line">                        res += str</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            z: index === <span class="number">0</span> ? <span class="number">1</span> : <span class="number">2</span>,</span><br><span class="line">            data: [item]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> series = []</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> dataList) &#123;</span><br><span class="line">    series.push(...buildSeries(i))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">option = &#123;</span><br><span class="line">    tooltip: &#123;&#125;,</span><br><span class="line">    radar: &#123;</span><br><span class="line">        indicator: indicator</span><br><span class="line">    &#125;,</span><br><span class="line">    series: series</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4、源码地址"><a href="#4、源码地址" class="headerlink" title="4、源码地址"></a>4、源码地址</h3><p><a href="https://github.com/chrischen0405/Demo/blob/master/echarts/7-1radar.js" target="_blank" rel="noopener">https://github.com/chrischen0405/Demo/blob/master/echarts/7-1radar.js</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;1、遇到问题&quot;&gt;&lt;a href=&quot;#1、遇到问题&quot; class=&quot;headerlink&quot; title=&quot;1、遇到问题&quot;&gt;&lt;/a&gt;1、遇到问题&lt;/h3&gt;&lt;p&gt;在echarts雷达图中将&lt;code&gt;tooltip.trigger&lt;/code&gt;设置为&lt;code&gt;axis&lt;/code&gt;时失效，雷达图并不会显示单轴数据，而是整个雷达图的数据&lt;/p&gt;
    
    </summary>
    
      <category term="Echarts" scheme="http://chrischen0405.github.io/categories/Echarts/"/>
    
    
      <category term="Echarts" scheme="http://chrischen0405.github.io/tags/Echarts/"/>
    
      <category term="tooltip" scheme="http://chrischen0405.github.io/tags/tooltip/"/>
    
      <category term="axis" scheme="http://chrischen0405.github.io/tags/axis/"/>
    
      <category term="雷达图" scheme="http://chrischen0405.github.io/tags/%E9%9B%B7%E8%BE%BE%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>Echarts tooltip formatter函数使用</title>
    <link href="http://chrischen0405.github.io/2022/05/20/post20220520/"/>
    <id>http://chrischen0405.github.io/2022/05/20/post20220520/</id>
    <published>2022-05-20T09:09:24.000Z</published>
    <updated>2022-09-23T02:30:42.329Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/13924215-536d0c54c8418216.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tooltip"></p><p>实现如上默认的tooltip样式，<code>tooltip</code>配置部分代码如下：</p><a id="more"></a><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">tooltip: &#123;</span><br><span class="line">    trigger: <span class="string">'axis'</span>,</span><br><span class="line">        axisPointer: &#123;            <span class="comment">// 坐标轴指示器，坐标轴触发有效</span></span><br><span class="line">        type: <span class="string">'line'</span>        <span class="comment">// 默认为直线，可选为：'line' | 'shadow'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    formatter: <span class="function">(<span class="params">params</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> list = []</span><br><span class="line">        <span class="keyword">let</span> listItem = <span class="string">''</span></span><br><span class="line">        <span class="keyword">let</span> axisValueLabel = params[<span class="number">0</span>].axisValueLabel</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; params.length; i++) &#123;</span><br><span class="line">            list.push(</span><br><span class="line">                <span class="string">'&lt;i style="display: inline-block;width: 10px;height: 10px;background: '</span> +</span><br><span class="line">                params[i].color +</span><br><span class="line">                <span class="string">';margin-right: 5px;border-radius: 50%;&#125;"&gt;&lt;/i&gt;'</span> +</span><br><span class="line">                <span class="string">'&lt;span style="display:inline-block;"&gt;'</span> +</span><br><span class="line">                params[i].seriesName +</span><br><span class="line">                <span class="string">'&lt;/span&gt;&lt;span style="display:inline-block;"&gt;&amp;nbsp&amp;nbsp'</span> +</span><br><span class="line">                params[i].data +</span><br><span class="line">                <span class="string">'&lt;/span&gt;'</span></span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">        listItem = list.join(<span class="string">'&lt;br&gt;'</span>)</span><br><span class="line">        <span class="keyword">return</span> axisValueLabel + <span class="string">'&lt;br&gt;'</span> + listItem</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>具体想获取的数据在<code>params</code>中查找，每次弹出tooltip都会触发一次<code>formatter</code>回调函数</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/13924215-536d0c54c8418216.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;tooltip&quot;&gt;&lt;/p&gt;
&lt;p&gt;实现如上默认的tooltip样式，&lt;code&gt;tooltip&lt;/code&gt;配置部分代码如下：&lt;/p&gt;
    
    </summary>
    
      <category term="Echarts" scheme="http://chrischen0405.github.io/categories/Echarts/"/>
    
    
      <category term="函数" scheme="http://chrischen0405.github.io/tags/%E5%87%BD%E6%95%B0/"/>
    
      <category term="Echarts" scheme="http://chrischen0405.github.io/tags/Echarts/"/>
    
      <category term="tooltip" scheme="http://chrischen0405.github.io/tags/tooltip/"/>
    
      <category term="formatter" scheme="http://chrischen0405.github.io/tags/formatter/"/>
    
  </entry>
  
  <entry>
    <title>webstorm快捷键</title>
    <link href="http://chrischen0405.github.io/2022/05/19/post20220519/"/>
    <id>http://chrischen0405.github.io/2022/05/19/post20220519/</id>
    <published>2022-05-19T09:27:35.000Z</published>
    <updated>2022-09-23T02:23:21.807Z</updated>
    
    <content type="html"><![CDATA[<p>ctrl+/ 单行注释<br>ctrl+shift+/ 块注释<br>ctrl+shift+ +/- 展开/折叠<br>ctrl+alt+L 格式化代码<br>ctrl+shift+ up/down 上下移动句子</p><a id="more"></a><p>Alt+回车 导入包,自动修正<br>Ctrl+N 查找类<br>Ctrl+Shift+N 查找文件<br>Ctrl+Alt+L 格式化代码<br>Ctrl+Alt+O 优化导入的类和包<br>Alt+Insert 生成代码(如get,set方法,构造函数等)<br>Ctrl+E或者Alt+Shift+C 最近更改的代码<br>Ctrl+R 替换文本<br>Ctrl+F 查找文本<br>Ctrl+Shift+Space 自动补全代码<br>Ctrl+空格 代码提示<br>Ctrl+Alt+Space 类名或接口名提示<br>Ctrl+P 方法参数提示<br>Ctrl+Shift+Alt+N 查找类中的方法或变量<br>Alt+Shift+C 对比最近修改的代码</p><p>Shift+F6 重构-重命名<br>Ctrl+Shift+先上键<br>Ctrl+X 删除行<br>Ctrl+D 复制行<br>Ctrl+/ 或 Ctrl+Shift+/ 注释（// 或者/<em>…</em>/ ）<br>Ctrl+J 自动代码<br>Ctrl+E 最近打开的文件<br>Ctrl+H 显示类结构图<br>Ctrl+Q 显示注释文档<br>Alt+F1 查找代码所在位置<br>Alt+1 快速打开或隐藏工程面板<br>Ctrl+Alt+ left/right 返回至上次浏览的位置<br>Alt+ left/right 切换代码视图<br>Alt+ Up/Down 在方法间快速移动定位<br>Ctrl+Shift+Up/Down 代码向上/下移动。<br>F2 或Shift+F2 高亮错误或警告快速定位</p><p>代码标签输入完成后，按Tab，生成代码。<br>选中文本，按Ctrl+Shift+F7 ，高亮显示所有该文本，按Esc高亮消失。<br>Ctrl+W 选中代码，连续按会有其他效果<br>选中文本，按Alt+F3 ，逐个往下查找相同文本，并高亮显示。<br>Ctrl+Up/Down 光标跳转到第一行或最后一行下<br>Ctrl+B 快速打开光标处的类或方法</p><h3 id="查找-代替"><a href="#查找-代替" class="headerlink" title="查找/代替"></a>查找/代替</h3><p>ctrl+shift+N 通过文件名快速查找工程内的文件（必记）<br>ctrl+shift+alt+N 通过一个字符快速查找位置（必记）<br>ctrl+F 在文件内快速查找代码<br>F3 查找下一个<br>shift+F3 查找上一个<br>ctrl+R 文件内代码替换<br>ctrl+shift+R 指定目录内代码批量替换<br>ctrl+shift+F 指定目录内代码批量查找<br>ctrl+R 文件内代码替换</p><h3 id="界面操作"><a href="#界面操作" class="headerlink" title="界面操作"></a>界面操作</h3><p>ctrl+shift+A 快速查找并使用编辑器所有功能（必记）</p><p>alt+[0-9] 快速拆合功能界面模块<br>ctrl+shift+F12 最大区域显示代码（会隐藏其他的功能界面模块）<br>alt+shift+F 将当前文件加入收藏夹<br>ctrl+alt+s 打开配置窗口<br>ctrl+tab 切换代码选项卡（还要进行此选择，效率差些）<br>alt+&lt;-或-&gt; 切换代码选项卡</p><p>ctrl+shift+N 通过文件名快速查找工程内的文件（必记）<br>ctrl+shift+alt+N 通过一个字符快速查找位置（必记）<br>ctrl+F 在文件内快速查找代码<br>F3 查找下一个<br>shift+F3 查找上一个<br>ctrl+R 文件内代码替换<br>ctrl+shift+R 指定目录内代码批量替换<br>ctrl+shift+F 指定目录内代码批量查找<br>ctrl+R 文件内代码替换</p><p>ctrl+F4 关闭当前代码选项卡</p><p>ctrl+D 复制当前行<br>ctrl+W 选中单词<br>ctrl+&lt;-或-&gt; 以单词作为边界跳光标位置<br>alt+Insert 新建一个文件或其他<br>ctrl+alt+L 格式化代码<br>shift+tab/tab 减少/扩大缩进（可以在代码中减少行缩进）<br>ctrl+Y 删除一行<br>shift+enter 重新开始一行（无论光标在哪个位置）</p><h3 id="导航"><a href="#导航" class="headerlink" title="导航"></a>导航</h3><p>esc 进入代码编辑区域<br>alt+F1 查找代码在其他界面模块的位置，颇为有用<br>ctrl+G 到指定行的代码<br>ctrl+]/[ 光标到代码块的前面或后面<br>alt+up/down 上一个/下一个方法</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ctrl+/ 单行注释&lt;br&gt;ctrl+shift+/ 块注释&lt;br&gt;ctrl+shift+ +/- 展开/折叠&lt;br&gt;ctrl+alt+L 格式化代码&lt;br&gt;ctrl+shift+ up/down 上下移动句子&lt;/p&gt;
    
    </summary>
    
      <category term="工具" scheme="http://chrischen0405.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="工具" scheme="http://chrischen0405.github.io/tags/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="webstorm" scheme="http://chrischen0405.github.io/tags/webstorm/"/>
    
      <category term="快捷键" scheme="http://chrischen0405.github.io/tags/%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
    
  </entry>
  
  <entry>
    <title>vue事件代理</title>
    <link href="http://chrischen0405.github.io/2022/05/10/post20220510/"/>
    <id>http://chrischen0405.github.io/2022/05/10/post20220510/</id>
    <published>2022-05-10T11:20:53.000Z</published>
    <updated>2022-09-22T10:00:47.875Z</updated>
    
    <content type="html"><![CDATA[<p>一般使用 <code>v-for</code>遍历数组然后给每个子元素绑定<code>onClick</code>方法然后传入下标：</p><a id="more"></a><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"(item, index) in list"</span> <span class="attr">:key</span>=<span class="string">"index"</span> @<span class="attr">click</span>=<span class="string">"onClick(index)"</span>&gt;</span></span><br><span class="line">                &#123;&#123;item&#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">    name: <span class="string">'tips1'</span>, <span class="comment">// vue事件代理</span></span></span><br><span class="line"><span class="undefined">    data () &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">            list: [<span class="string">'项目1'</span>, <span class="string">'项目2'</span>, <span class="string">'项目3'</span>]</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;,</span></span><br><span class="line"><span class="undefined">    methods: &#123;</span></span><br><span class="line"><span class="undefined">        onClick (index) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(index)</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>但如果列表很长需要渲染的元素很多，在每一个子元素上都绑定<code>onClick</code>方法会消耗性能。</p><p>可以使用事件代理，只在父元素上绑定<code>onClick</code>方法，在子元素上绑定自定义属性<code>data-index</code>，赋值下标，当点击子元素时，父元素的点击事件捕获子元素的点击事件，然后在点击事件的回调函数中使用<code>e.target.getAttribute(&#39;data-index&#39;)</code>，来获取绑定在自定义属性<code>data-index</code>上的下标：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> @<span class="attr">click</span>=<span class="string">"onClick"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"(item, index) in list"</span> <span class="attr">:key</span>=<span class="string">"index"</span> <span class="attr">:data-index</span>=<span class="string">"index"</span>&gt;</span></span><br><span class="line">                &#123;&#123;item&#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">    name: <span class="string">'tips1'</span>, <span class="comment">// vue事件代理</span></span></span><br><span class="line"><span class="undefined">    data () &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">            list: [<span class="string">'项目1'</span>, <span class="string">'项目2'</span>, <span class="string">'项目3'</span>]</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;,</span></span><br><span class="line"><span class="undefined">    methods: &#123;</span></span><br><span class="line"><span class="undefined">        onClick (e) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">const</span> index = e.target.getAttribute(<span class="string">'data-index'</span>)</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(index)</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;一般使用 &lt;code&gt;v-for&lt;/code&gt;遍历数组然后给每个子元素绑定&lt;code&gt;onClick&lt;/code&gt;方法然后传入下标：&lt;/p&gt;
    
    </summary>
    
      <category term="Vue" scheme="http://chrischen0405.github.io/categories/Vue/"/>
    
    
      <category term="Vue" scheme="http://chrischen0405.github.io/tags/Vue/"/>
    
      <category term="事件" scheme="http://chrischen0405.github.io/tags/%E4%BA%8B%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>el-table二次封装</title>
    <link href="http://chrischen0405.github.io/2022/04/06/post20220406/"/>
    <id>http://chrischen0405.github.io/2022/04/06/post20220406/</id>
    <published>2022-04-06T10:17:00.000Z</published>
    <updated>2022-09-22T09:59:18.191Z</updated>
    
    <content type="html"><![CDATA[<p>在vue开发中使用element-ui的el-table时一般都需要进行封装以便于复用，提高开发效率，减少重复代码，这篇博客对el-table进行简单的二次封装：</p><a id="more"></a><h2 id="一、安装引入"><a href="#一、安装引入" class="headerlink" title="一、安装引入"></a>一、安装引入</h2><p><a href="https://element.eleme.cn/#/zh-CN/component/installation" target="_blank" rel="noopener">Element官方文档</a></p><p><code>npm</code>安装element-ui：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i element-ui -S</span><br></pre></td></tr></table></figure></p><p>可以看文档按需引入，这里为了方便直接全局引入了：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.vue'</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./router'</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store'</span></span><br><span class="line"><span class="keyword">import</span> ElementUI <span class="keyword">from</span> <span class="string">'element-ui'</span> <span class="comment">// 全局引入element-ui</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'element-ui/lib/theme-chalk/index.css'</span> <span class="comment">// 样式文件需要单独引入</span></span><br><span class="line"></span><br><span class="line">Vue.config.productionTip = <span class="literal">false</span></span><br><span class="line">Vue.use(ElementUI)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    router,</span><br><span class="line">    store,</span><br><span class="line">    render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;).$mount(<span class="string">'#app'</span>)</span><br></pre></td></tr></table></figure></p><h2 id="二、封装功能"><a href="#二、封装功能" class="headerlink" title="二、封装功能"></a>二、封装功能</h2><p>新建一个chris-el-table组件，遍历表头变量<code>tableTitle</code>使用<code>v-for</code>循环生成<code>el-table-column</code>，使用<code>slot</code>来实现自定义单元格：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"table-container"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:data</span>=<span class="string">"tableData"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">width</span>=<span class="string">"100%"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:row-class-name</span>=<span class="string">"rowClassName"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:height</span>=<span class="string">"height"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:row-style</span>=<span class="string">"&#123;height: `$&#123;rowHeight&#125;px`&#125;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-for</span>=<span class="string">"(item, index) in tableTitle"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">slot</span> <span class="attr">v-if</span>=<span class="string">"item.slot"</span> <span class="attr">:name</span>=<span class="string">"item.slot"</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">v-else</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">:key</span>=<span class="string">"index"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">:prop</span>=<span class="string">"item.property"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">:label</span>=<span class="string">"item.label"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">:min-width</span>=<span class="string">"item.minWidth ? item.minWidth : ''"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">:width</span>=<span class="string">"item.width ? item.width : ''"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">    name: <span class="string">'chris-el-table'</span>,</span></span><br><span class="line"><span class="undefined">    props: &#123;</span></span><br><span class="line"><span class="javascript">        tableData: &#123; <span class="comment">// 表格数据</span></span></span><br><span class="line"><span class="javascript">            type: <span class="built_in">Array</span>,</span></span><br><span class="line"><span class="javascript">            <span class="keyword">default</span>: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> []</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="javascript">        tableTitle: &#123; <span class="comment">// 表格头标题</span></span></span><br><span class="line"><span class="javascript">            type: <span class="built_in">Array</span>,</span></span><br><span class="line"><span class="javascript">            <span class="built_in">require</span>: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="javascript">        height: &#123; <span class="comment">// 表格高度</span></span></span><br><span class="line"><span class="javascript">            type: [<span class="built_in">Number</span>, <span class="built_in">String</span>],</span></span><br><span class="line"><span class="javascript">            <span class="keyword">default</span>: <span class="string">'100%'</span></span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="javascript">        rowHeight: &#123; <span class="comment">// 表格行高</span></span></span><br><span class="line"><span class="javascript">            type: [<span class="built_in">Number</span>, <span class="built_in">String</span>],</span></span><br><span class="line"><span class="javascript">            <span class="keyword">default</span>: <span class="number">44</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;,</span></span><br><span class="line"><span class="undefined">    data () &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> &#123;&#125;</span></span><br><span class="line"><span class="undefined">    &#125;,</span></span><br><span class="line"><span class="undefined">    methods: &#123;</span></span><br><span class="line"><span class="undefined">        rowClassName (e) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> e.rowIndex % <span class="number">2</span> === <span class="number">0</span> ? <span class="string">''</span> : <span class="string">'light-line'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="三、样式覆盖"><a href="#三、样式覆盖" class="headerlink" title="三、样式覆盖"></a>三、样式覆盖</h2><p>根据需要覆盖el-table的默认样式：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span> <span class="attr">lang</span>=<span class="string">"scss"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.table-container</span> &#123;</span></span><br><span class="line"><span class="undefined">    /deep/ .el-table &#123;</span></span><br><span class="line"><span class="undefined">        background-color: transparent;</span></span><br><span class="line"><span class="undefined">        &amp;::before &#123; // 表格底部边框</span></span><br><span class="line"><span class="undefined">            background: none;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">        tbody tr:hover &gt; td &#123; // 表格触碰样式</span></span><br><span class="line"><span class="css">            <span class="selector-tag">background-color</span>: <span class="selector-id">#F5F7FA</span>;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">    /deep/ .el-table__header-wrapper &#123;</span></span><br><span class="line"><span class="undefined">        .el-table__cell &#123; // 表头样式</span></span><br><span class="line"><span class="undefined">            height: 44px;</span></span><br><span class="line"><span class="undefined">            padding: 0;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">background</span>: <span class="selector-id">#FFFFFF</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">border-bottom</span>: <span class="selector-id">#EBEEF5</span> <span class="selector-tag">solid</span> 1<span class="selector-tag">px</span> !<span class="selector-tag">important</span>;</span></span><br><span class="line"><span class="undefined">            text-align: center;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">    /deep/ .el-table__body-wrapper &#123;</span></span><br><span class="line"><span class="undefined">        &amp;::-webkit-scrollbar &#123; // 表格滚动条</span></span><br><span class="line"><span class="undefined">            width: 0 !important;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">        .el-table__row &#123; // 表格行样式</span></span><br><span class="line"><span class="css">            <span class="selector-tag">background-color</span>: <span class="selector-id">#F5F7FA</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-class">.el-table__cell</span> &#123;</span></span><br><span class="line"><span class="undefined">                padding: 0;</span></span><br><span class="line"><span class="undefined">                text-align: center;</span></span><br><span class="line"><span class="css">                <span class="selector-tag">border-bottom</span>: <span class="selector-id">#EBEEF5</span> <span class="selector-tag">solid</span> 1<span class="selector-tag">px</span> !<span class="selector-tag">important</span>;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">        .light-line &#123; // 高亮行颜色</span></span><br><span class="line"><span class="css">            <span class="selector-tag">background-color</span>: <span class="selector-id">#FFFFFF</span>;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="四、使用组件"><a href="#四、使用组件" class="headerlink" title="四、使用组件"></a>四、使用组件</h2><p>直接传入表头数据<code>tableTitle</code>和表格数据<code>tableData</code>：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">chris-el-table</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:table-title</span>=<span class="string">"tableTitle"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:table-data</span>=<span class="string">"tableData"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">chris-el-table</span>&gt;</span></span><br></pre></td></tr></table></figure><p>表头数据<code>tableTitle</code>大概是这样：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">tableTitle: [</span><br><span class="line">    &#123;</span><br><span class="line">        label: <span class="string">'日期'</span>,</span><br><span class="line">        property: <span class="string">'date'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        label: <span class="string">'姓名'</span>,</span><br><span class="line">        property: <span class="string">'name'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        label: <span class="string">'地址'</span>,</span><br><span class="line">        property: <span class="string">'address'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        slot: <span class="string">'handle'</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>表格数据<code>tableData</code>对应<code>property</code>，大概长这样：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">tableData: [</span><br><span class="line">    &#123;</span><br><span class="line">        date: <span class="string">'2016-05-02'</span>,</span><br><span class="line">        name: <span class="string">'王小虎'</span>,</span><br><span class="line">        address: <span class="string">'上海市普陀区金沙江路 1518 弄'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        date: <span class="string">'2016-05-04'</span>,</span><br><span class="line">        name: <span class="string">'王小虎'</span>,</span><br><span class="line">        address: <span class="string">'上海市普陀区金沙江路 1517 弄'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        date: <span class="string">'2016-05-01'</span>,</span><br><span class="line">        name: <span class="string">'王小虎'</span>,</span><br><span class="line">        address: <span class="string">'上海市普陀区金沙江路 1519 弄'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        date: <span class="string">'2016-05-03'</span>,</span><br><span class="line">        name: <span class="string">'王小虎'</span>,</span><br><span class="line">        address: <span class="string">'上海市普陀区金沙江路 1516 弄'</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>需要自定义的单元格使用<code>slot</code>，对<code>el-table-column</code>进行修改：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">chris-el-table</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:table-title</span>=<span class="string">"tableTitle"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:table-data</span>=<span class="string">"tableData"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">slot</span>=<span class="string">"handle"</span> <span class="attr">label</span>=<span class="string">"操作"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"scope"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">"handleClick(scope.row)"</span>&gt;</span>查看<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">chris-el-table</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="五、源码"><a href="#五、源码" class="headerlink" title="五、源码"></a>五、源码</h2><p>源码扔在最后：<a href="https://github.com/chrischen0405/element-component-in-vue" target="_blank" rel="noopener">https://github.com/chrischen0405/element-component-in-vue</a> </p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在vue开发中使用element-ui的el-table时一般都需要进行封装以便于复用，提高开发效率，减少重复代码，这篇博客对el-table进行简单的二次封装：&lt;/p&gt;
    
    </summary>
    
      <category term="elementUI" scheme="http://chrischen0405.github.io/categories/elementUI/"/>
    
    
      <category term="Vue" scheme="http://chrischen0405.github.io/tags/Vue/"/>
    
      <category term="elementUI" scheme="http://chrischen0405.github.io/tags/elementUI/"/>
    
      <category term="el-table" scheme="http://chrischen0405.github.io/tags/el-table/"/>
    
      <category term="封装" scheme="http://chrischen0405.github.io/tags/%E5%B0%81%E8%A3%85/"/>
    
  </entry>
  
  <entry>
    <title>You are using the runtime-only build of Vue where the template compiler is not available.</title>
    <link href="http://chrischen0405.github.io/2022/03/16/post20220316/"/>
    <id>http://chrischen0405.github.io/2022/03/16/post20220316/</id>
    <published>2022-03-16T10:10:47.000Z</published>
    <updated>2022-09-22T09:56:30.859Z</updated>
    
    <content type="html"><![CDATA[<p>vue报错：You are using the runtime-only build of Vue where the template compiler is not available. Either pre-compile the templates into render functions, or use the compiler-included build.</p><a id="more"></a><h2 id="原因分析："><a href="#原因分析：" class="headerlink" title="原因分析："></a>原因分析：</h2><p><strong>在项目配置的时候，默认 npm 包导出的是运行时构建，即 runtime 版本，不支持编译 template 模板。</strong></p><p>vue 在初始化项目配置的时候，有两个运行环境配置的版本：Compiler 版本、Runtime 版本。</p><h4 id="1-Compiler-版本："><a href="#1-Compiler-版本：" class="headerlink" title="1.  Compiler 版本："></a>1.  Compiler 版本：</h4><p>可以对template模板内容进行编译（包括字符串模板和可以绑定的html对象作为模板）。</p><h4 id="2-Runtime-版本："><a href="#2-Runtime-版本：" class="headerlink" title="2. Runtime 版本："></a>2. Runtime 版本：</h4><p>使用 vue-loader 加载.vue文件（组件文件）时，webpack 在打包过程中对模板进行了渲染。</p><h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><p>在vue.config.js文件中加上webpack的配置：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">configureWebpack: &#123;</span><br><span class="line">        resolve: &#123;</span><br><span class="line">            alias: &#123;</span><br><span class="line">                <span class="string">'vue$'</span>: <span class="string">'vue/dist/vue.esm.js'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;vue报错：You are using the runtime-only build of Vue where the template compiler is not available. Either pre-compile the templates into render functions, or use the compiler-included build.&lt;/p&gt;
    
    </summary>
    
      <category term="踩坑" scheme="http://chrischen0405.github.io/categories/%E8%B8%A9%E5%9D%91/"/>
    
    
      <category term="报错" scheme="http://chrischen0405.github.io/tags/%E6%8A%A5%E9%94%99/"/>
    
      <category term="npm" scheme="http://chrischen0405.github.io/tags/npm/"/>
    
      <category term="Vue" scheme="http://chrischen0405.github.io/tags/Vue/"/>
    
      <category term="webpack" scheme="http://chrischen0405.github.io/tags/webpack/"/>
    
  </entry>
  
  <entry>
    <title>js中对象的属性描述对象</title>
    <link href="http://chrischen0405.github.io/2022/01/20/post20220120/"/>
    <id>http://chrischen0405.github.io/2022/01/20/post20220120/</id>
    <published>2022-01-20T07:10:47.000Z</published>
    <updated>2022-09-22T09:54:30.743Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-概述"><a href="#1-概述" class="headerlink" title="1.概述"></a>1.概述</h2><p>JavaScript 提供了一个内部数据结构，用来描述对象的属性，控制它的行为，比如该属性是否可写、可遍历等等。这个内部数据结构称为“属性描述对象”（attributes object）。每个属性都有自己对应的属性描述对象，保存该属性的一些元信息。</p><a id="more"></a><p>下面是属性描述对象的一个例子。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  value: <span class="number">123</span>,</span><br><span class="line">  writable: <span class="literal">false</span>,</span><br><span class="line">  enumerable: <span class="literal">true</span>,</span><br><span class="line">  configurable: <span class="literal">false</span>,</span><br><span class="line">  get: <span class="literal">undefined</span>,</span><br><span class="line">  set: <span class="literal">undefined</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>属性描述对象提供6个元属性。</p><p>（1）<code>value</code></p><p><code>value</code>是该属性的属性值，默认为<code>undefined</code>。</p><p>（2）<code>writable</code></p><p><code>writable</code>是一个布尔值，表示属性值（value）是否可改变（即是否可写），默认为<code>true</code>。</p><p>（3）<code>enumerable</code></p><p><code>enumerable</code>是一个布尔值，表示该属性是否可遍历，默认为<code>true</code>。如果设为<code>false</code>，会使得某些操作（比如<code>for...in</code>循环、<code>Object.keys()</code>）跳过该属性。</p><p>（4）<code>configurable</code></p><p><code>configurable</code>是一个布尔值，表示属性的可配置性，默认为<code>true</code>。如果设为<code>false</code>，将阻止某些操作改写属性描述对象，比如无法删除该属性，也不得改变各种元属性（<code>value</code>属性除外）。也就是说，<code>configurable</code>属性控制了属性描述对象的可写性。</p><p>（5）<code>get</code></p><p><code>get</code>是一个函数，表示该属性的取值函数（getter），默认为<code>undefined</code>。</p><p>（6）<code>set</code></p><p><code>set</code>是一个函数，表示该属性的存值函数（setter），默认为<code>undefined</code>。</p><h2 id="2-Object-getOwnPropertyDescriptor"><a href="#2-Object-getOwnPropertyDescriptor" class="headerlink" title="2.Object.getOwnPropertyDescriptor()"></a>2.Object.getOwnPropertyDescriptor()</h2><p><code>Object.getOwnPropertyDescriptor()</code>方法可以获取属性描述对象。它的第一个参数是目标对象，第二个参数是一个字符串，对应目标对象的某个属性名。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">p</span>: <span class="string">'a'</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">'p'</span>)</span><br><span class="line"><span class="comment">// Object &#123; value: "a",</span></span><br><span class="line"><span class="comment">//   writable: true,</span></span><br><span class="line"><span class="comment">//   enumerable: true,</span></span><br><span class="line"><span class="comment">//   configurable: true</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>Object.getOwnPropertyDescriptor()</code>方法获取<code>obj.p</code>的属性描述对象。</p><p><strong>注意，<code>Object.getOwnPropertyDescriptor()</code>方法只能用于对象自身的属性，不能用于继承的属性</strong>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">p</span>: <span class="string">'a'</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">'toString'</span>)</span><br><span class="line"><span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>toString</code>是<code>obj</code>对象继承的属性，<code>Object.getOwnPropertyDescriptor()</code>无法获取。</p><h2 id="3-Object-getOwnPropertyNames"><a href="#3-Object-getOwnPropertyNames" class="headerlink" title="3.Object.getOwnPropertyNames()"></a>3.Object.getOwnPropertyNames()</h2><p><code>Object.getOwnPropertyNames</code>方法返回一个数组，成员是参数对象自身的全部属性的属性名，不管该属性是否可遍历。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.defineProperties(&#123;&#125;, &#123;</span><br><span class="line">  p1: &#123; <span class="attr">value</span>: <span class="number">1</span>, <span class="attr">enumerable</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  p2: &#123; <span class="attr">value</span>: <span class="number">2</span>, <span class="attr">enumerable</span>: <span class="literal">false</span> &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyNames(obj)</span><br><span class="line"><span class="comment">// ["p1", "p2"]</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>obj.p1</code>是可遍历的，<code>obj.p2</code>是不可遍历的。<code>Object.getOwnPropertyNames</code>会将它们都返回。</p><p>这跟<code>Object.keys</code>的行为不同，<code>Object.keys</code>只返回对象自身的可遍历属性的全部属性名。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.keys([]) <span class="comment">// []</span></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyNames([]) <span class="comment">// [ 'length' ]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.keys(<span class="built_in">Object</span>.prototype) <span class="comment">// []</span></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyNames(<span class="built_in">Object</span>.prototype)</span><br><span class="line"><span class="comment">// ['hasOwnProperty',</span></span><br><span class="line"><span class="comment">//  'valueOf',</span></span><br><span class="line"><span class="comment">//  'constructor',</span></span><br><span class="line"><span class="comment">//  'toLocaleString',</span></span><br><span class="line"><span class="comment">//  'isPrototypeOf',</span></span><br><span class="line"><span class="comment">//  'propertyIsEnumerable',</span></span><br><span class="line"><span class="comment">//  'toString']</span></span><br></pre></td></tr></table></figure><p>上面代码中，数组自身的<code>length</code>属性是不可遍历的，<code>Object.keys</code>不会返回该属性。第二个例子的<code>Object.prototype</code>也是一个对象，所有实例对象都会继承它，它自身的属性都是不可遍历的。</p><h2 id="4-Object-defineProperty-，Object-defineProperties"><a href="#4-Object-defineProperty-，Object-defineProperties" class="headerlink" title="4.Object.defineProperty()，Object.defineProperties()"></a>4.Object.defineProperty()，Object.defineProperties()</h2><p><code>Object.defineProperty()</code>方法允许通过属性描述对象，定义或修改一个属性，然后返回修改后的对象，它的用法如下。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.defineProperty(object, propertyName, attributesObject)</span><br></pre></td></tr></table></figure><p><code>Object.defineProperty</code>方法接受三个参数，依次如下。</p><ul><li>object：属性所在的对象</li><li>propertyName：字符串，表示属性名</li><li>attributesObject：属性描述对象</li></ul><p>举例来说，定义<code>obj.p</code>可以写成下面这样。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'p'</span>, &#123;</span><br><span class="line">  value: <span class="number">123</span>,</span><br><span class="line">  writable: <span class="literal">false</span>,</span><br><span class="line">  enumerable: <span class="literal">true</span>,</span><br><span class="line">  configurable: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">obj.p <span class="comment">// 123</span></span><br><span class="line"></span><br><span class="line">obj.p = <span class="number">246</span>;</span><br><span class="line">obj.p <span class="comment">// 123</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>Object.defineProperty()</code>方法定义了<code>obj.p</code>属性。由于属性描述对象的<code>writable</code>属性为<code>false</code>，所以<code>obj.p</code>属性不可写。注意，这里的<code>Object.defineProperty</code>方法的第一个参数是<code>{}</code>（一个新建的空对象），<code>p</code>属性直接定义在这个空对象上面，然后返回这个对象，这是<code>Object.defineProperty()</code>的常见用法。</p><p>如果属性已经存在，<code>Object.defineProperty()</code>方法相当于更新该属性的属性描述对象。</p><p>如果一次性定义或修改多个属性，可以使用<code>Object.defineProperties()</code>方法。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.defineProperties(&#123;&#125;, &#123;</span><br><span class="line">  p1: &#123; <span class="attr">value</span>: <span class="number">123</span>, <span class="attr">enumerable</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  p2: &#123; <span class="attr">value</span>: <span class="string">'abc'</span>, <span class="attr">enumerable</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  p3: &#123; <span class="attr">get</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">this</span>.p1 + <span class="keyword">this</span>.p2 &#125;,</span><br><span class="line">    enumerable:<span class="literal">true</span>,</span><br><span class="line">    configurable:<span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">obj.p1 <span class="comment">// 123</span></span><br><span class="line">obj.p2 <span class="comment">// "abc"</span></span><br><span class="line">obj.p3 <span class="comment">// "123abc"</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>Object.defineProperties()</code>同时定义了<code>obj</code>对象的三个属性。其中，<code>p3</code>属性定义了取值函数<code>get</code>，即每次读取该属性，都会调用这个取值函数。</p><p><strong>注意，一旦定义了取值函数<code>get</code>（或存值函数<code>set</code>），就不能将<code>writable</code>属性设为<code>true</code>，或者同时定义<code>value</code>属性，否则会报错。</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'p'</span>, &#123;</span><br><span class="line">  value: <span class="number">123</span>,</span><br><span class="line">  get: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="number">456</span>; &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// TypeError: Invalid property.</span></span><br><span class="line"><span class="comment">// A property cannot both have accessors and be writable or have a value</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'p'</span>, &#123;</span><br><span class="line">  writable: <span class="literal">true</span>,</span><br><span class="line">  get: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="number">456</span>; &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// TypeError: Invalid property descriptor.</span></span><br><span class="line"><span class="comment">// Cannot both specify accessors and a value or writable attribute</span></span><br></pre></td></tr></table></figure><p>上面代码中，同时定义了<code>get</code>属性和<code>value</code>属性，以及将<code>writable</code>属性设为<code>true</code>，就会报错。</p><p><code>Object.defineProperty()</code>和<code>Object.defineProperties()</code>参数里面的属性描述对象，<code>writable</code>、<code>configurable</code>、<code>enumerable</code>这三个属性的默认值都为<code>false</code>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'foo'</span>, &#123;&#125;);</span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">'foo'</span>)</span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   value: undefined,</span></span><br><span class="line"><span class="comment">//   writable: false,</span></span><br><span class="line"><span class="comment">//   enumerable: false,</span></span><br><span class="line"><span class="comment">//   configurable: false</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure><p>上面代码中，定义<code>obj.foo</code>时用了一个空的属性描述对象，就可以看到各个元属性的默认值。</p><h2 id="5-Object-prototype-propertyIsEnumerable"><a href="#5-Object-prototype-propertyIsEnumerable" class="headerlink" title="5.Object.prototype.propertyIsEnumerable()"></a>5.Object.prototype.propertyIsEnumerable()</h2><p>实例对象的<code>propertyIsEnumerable()</code>方法返回一个布尔值，用来判断某个属性是否可遍历。<strong>注意，这个方法只能用于判断对象自身的属性，对于继承的属性一律返回<code>false</code></strong>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">obj.p = <span class="number">123</span>;</span><br><span class="line"></span><br><span class="line">obj.propertyIsEnumerable(<span class="string">'p'</span>) <span class="comment">// true</span></span><br><span class="line">obj.propertyIsEnumerable(<span class="string">'toString'</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>obj.p</code>是可遍历的，而<code>obj.toString</code>是继承的属性。</p><h2 id="6-元属性"><a href="#6-元属性" class="headerlink" title="6.元属性"></a>6.元属性</h2><p>属性描述对象的各个属性称为“元属性”，因为它们可以看作是控制属性的属性。</p><h3 id="6-1-value"><a href="#6-1-value" class="headerlink" title="6.1 value"></a>6.1 value</h3><p><code>value</code>属性是目标属性的值。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">obj.p = <span class="number">123</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">'p'</span>).value</span><br><span class="line"><span class="comment">// 123</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'p'</span>, &#123; <span class="attr">value</span>: <span class="number">246</span> &#125;);</span><br><span class="line">obj.p <span class="comment">// 246</span></span><br></pre></td></tr></table></figure><p>上面代码是通过<code>value</code>属性，读取或改写<code>obj.p</code>的例子。</p><h3 id="6-2-writable"><a href="#6-2-writable" class="headerlink" title="6.2 writable"></a>6.2 writable</h3><p><code>writable</code>属性是一个布尔值，决定了目标属性的值（<code>value</code>）是否可以被改变。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'a'</span>, &#123;</span><br><span class="line">  value: <span class="number">37</span>,</span><br><span class="line">  writable: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">obj.a <span class="comment">// 37</span></span><br><span class="line">obj.a = <span class="number">25</span>;</span><br><span class="line">obj.a <span class="comment">// 37</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>obj.a</code>的<code>writable</code>属性是<code>false</code>。然后，改变<code>obj.a</code>的值，不会有任何效果。</p><p><strong>注意，正常模式下，对<code>writable</code>为<code>false</code>的属性赋值不会报错，只会默默失败。但是，严格模式下会报错，即使对<code>a</code>属性重新赋予一个同样的值。</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'a'</span>, &#123;</span><br><span class="line">  value: <span class="number">37</span>,</span><br><span class="line">  writable: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">obj.a = <span class="number">37</span>;</span><br><span class="line"><span class="comment">// Uncaught TypeError: Cannot assign to read only property 'a' of object</span></span><br></pre></td></tr></table></figure><p>上面代码是严格模式，对<code>obj.a</code>任何赋值行为都会报错。</p><p>如果原型对象的某个属性的<code>writable</code>为<code>false</code>，那么子对象将无法自定义这个属性。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> proto = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'foo'</span>, &#123;</span><br><span class="line">  value: <span class="string">'a'</span>,</span><br><span class="line">  writable: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.create(proto);</span><br><span class="line"></span><br><span class="line">obj.foo = <span class="string">'b'</span>;</span><br><span class="line">obj.foo <span class="comment">// 'a'</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>proto</code>是原型对象，它的<code>foo</code>属性不可写。<code>obj</code>对象继承<code>proto</code>，也不可以再自定义这个属性了。如果是严格模式，这样做还会抛出一个错误。</p><p>但是，有一个规避方法，就是通过覆盖属性描述对象，绕过这个限制。原因是这种情况下，原型链会被完全忽视。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> proto = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'foo'</span>, &#123;</span><br><span class="line">  value: <span class="string">'a'</span>,</span><br><span class="line">  writable: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.create(proto);</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'foo'</span>, &#123;</span><br><span class="line">  value: <span class="string">'b'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">obj.foo <span class="comment">// "b"</span></span><br></pre></td></tr></table></figure><h3 id="6-3-enumerable"><a href="#6-3-enumerable" class="headerlink" title="6.3 enumerable"></a>6.3 enumerable</h3><p><code>enumerable</code>（可遍历性）返回一个布尔值，表示目标属性是否可遍历。</p><p>JavaScript 的早期版本，<code>for...in</code>循环是基于<code>in</code>运算符的。我们知道，<code>in</code>运算符不管某个属性是对象自身的还是继承的，都会返回<code>true</code>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"><span class="string">'toString'</span> <span class="keyword">in</span> obj <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>toString</code>不是<code>obj</code>对象自身的属性，但是<code>in</code>运算符也返回<code>true</code>，这导致了<code>toString</code>属性也会被<code>for...in</code>循环遍历。</p><p>这显然不太合理，后来就引入了“可遍历性”这个概念。只有可遍历的属性，才会被<code>for...in</code>循环遍历，同时还规定<code>toString</code>这一类实例对象继承的原生属性，都是不可遍历的，这样就保证了<code>for...in</code>循环的可用性。</p><p>具体来说，如果一个属性的<code>enumerable</code>为<code>false</code>，下面三个操作不会取到该属性。</p><ul><li><code>for..in</code>循环</li><li><code>Object.keys</code>方法</li><li><code>JSON.stringify</code>方法</li></ul><p>因此，<code>enumerable</code>可以用来设置“秘密”属性。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'x'</span>, &#123;</span><br><span class="line">  value: <span class="number">123</span>,</span><br><span class="line">  enumerable: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">obj.x <span class="comment">// 123</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.keys(obj)  <span class="comment">// []</span></span><br><span class="line"><span class="built_in">JSON</span>.stringify(obj) <span class="comment">// "&#123;&#125;"</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>obj.x</code>属性的<code>enumerable</code>为<code>false</code>，所以一般的遍历操作都无法获取该属性，使得它有点像“秘密”属性，但不是真正的私有属性，还是可以直接获取它的值。</p><p><strong>注意，<code>for...in</code>循环包括继承的属性，<code>Object.keys</code>方法不包括继承的属性。</strong>如果需要获取对象自身的所有属性，不管是否可遍历，可以使用<code>Object.getOwnPropertyNames</code>方法。</p><p>另外，<code>JSON.stringify</code>方法会排除<code>enumerable</code>为<code>false</code>的属性，有时可以利用这一点。如果对象的 JSON 格式输出要排除某些属性，就可以把这些属性的<code>enumerable</code>设为<code>false</code>。</p><h3 id="6-4-configurable"><a href="#6-4-configurable" class="headerlink" title="6.4 configurable"></a>6.4 configurable</h3><p><code>configurable</code>(可配置性）返回一个布尔值，决定了是否可以修改属性描述对象。也就是说，<code>configurable</code>为<code>false</code>时，<code>writable</code>、<code>enumerable</code>和<code>configurable</code>都不能被修改了。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'p'</span>, &#123;</span><br><span class="line">  value: <span class="number">1</span>,</span><br><span class="line">  writable: <span class="literal">false</span>,</span><br><span class="line">  enumerable: <span class="literal">false</span>,</span><br><span class="line">  configurable: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'p'</span>, &#123;<span class="attr">writable</span>: <span class="literal">true</span>&#125;)</span><br><span class="line"><span class="comment">// TypeError: Cannot redefine property: p</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'p'</span>, &#123;<span class="attr">enumerable</span>: <span class="literal">true</span>&#125;)</span><br><span class="line"><span class="comment">// TypeError: Cannot redefine property: p</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'p'</span>, &#123;<span class="attr">configurable</span>: <span class="literal">true</span>&#125;)</span><br><span class="line"><span class="comment">// TypeError: Cannot redefine property: p</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'p'</span>, &#123;<span class="attr">value</span>: <span class="number">2</span>&#125;)</span><br><span class="line"><span class="comment">// TypeError: Cannot redefine property: p</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>obj.p</code>的<code>configurable</code>属性为<code>false</code>。然后，改动<code>writable</code>、<code>enumerable</code>、<code>configurable</code>，结果都报错。</p><p><strong>注意，<code>writable</code>属性只有在<code>false</code>改为<code>true</code>时会报错，<code>true</code>改为<code>false</code>是允许的。</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'p'</span>, &#123;</span><br><span class="line">  writable: <span class="literal">true</span>,</span><br><span class="line">  configurable: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'p'</span>, &#123;<span class="attr">writable</span>: <span class="literal">false</span>&#125;)</span><br><span class="line"><span class="comment">// 修改成功</span></span><br></pre></td></tr></table></figure><p><code>value</code>属性的情况比较特殊。只要<code>writable</code>和<code>configurable</code>有一个为<code>true</code>，就允许改动<code>value</code>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o1 = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'p'</span>, &#123;</span><br><span class="line">  value: <span class="number">1</span>,</span><br><span class="line">  writable: <span class="literal">true</span>,</span><br><span class="line">  configurable: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(o1, <span class="string">'p'</span>, &#123;<span class="attr">value</span>: <span class="number">2</span>&#125;)</span><br><span class="line"><span class="comment">// 修改成功</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> o2 = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'p'</span>, &#123;</span><br><span class="line">  value: <span class="number">1</span>,</span><br><span class="line">  writable: <span class="literal">false</span>,</span><br><span class="line">  configurable: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(o2, <span class="string">'p'</span>, &#123;<span class="attr">value</span>: <span class="number">2</span>&#125;)</span><br><span class="line"><span class="comment">// 修改成功</span></span><br></pre></td></tr></table></figure><p>另外，<code>writable</code>为<code>false</code>时，直接对目标属性赋值，不报错，但不会成功。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'p'</span>, &#123;</span><br><span class="line">  value: <span class="number">1</span>,</span><br><span class="line">  writable: <span class="literal">false</span>,</span><br><span class="line">  configurable: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">obj.p = <span class="number">2</span>;</span><br><span class="line">obj.p <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>obj.p</code>的<code>writable</code>为<code>false</code>，对<code>obj.p</code>直接赋值不会生效。如果是严格模式，还会报错。</p><p>可配置性决定了目标属性是否可以被删除（delete）。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.defineProperties(&#123;&#125;, &#123;</span><br><span class="line">  p1: &#123; <span class="attr">value</span>: <span class="number">1</span>, <span class="attr">configurable</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  p2: &#123; <span class="attr">value</span>: <span class="number">2</span>, <span class="attr">configurable</span>: <span class="literal">false</span> &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> obj.p1 <span class="comment">// true</span></span><br><span class="line"><span class="keyword">delete</span> obj.p2 <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">obj.p1 <span class="comment">// undefined</span></span><br><span class="line">obj.p2 <span class="comment">// 2</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>obj.p1</code>的<code>configurable</code>是<code>true</code>，所以可以被删除，<code>obj.p2</code>就无法删除。</p><h2 id="7-存取器"><a href="#7-存取器" class="headerlink" title="7.存取器"></a>7.存取器</h2><p>除了直接定义以外，属性还可以用存取器（accessor）定义。其中，存值函数称为<code>setter</code>，使用属性描述对象的<code>set</code>属性；取值函数称为<code>getter</code>，使用属性描述对象的<code>get</code>属性。</p><p>一旦对目标属性定义了存取器，那么存取的时候，都将执行对应的函数。利用这个功能，可以实现许多高级特性，比如定制属性的读取和赋值行为。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'p'</span>, &#123;</span><br><span class="line">  get: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'getter'</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  set: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'setter: '</span> + value);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">obj.p <span class="comment">// "getter"</span></span><br><span class="line">obj.p = <span class="number">123</span> <span class="comment">// "setter: 123"</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>obj.p</code>定义了<code>get</code>和<code>set</code>属性。<code>obj.p</code>取值时，就会调用<code>get</code>；赋值时，就会调用<code>set</code>。</p><p>JavaScript 还提供了存取器的另一种写法。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 写法二</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  get p() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'getter'</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  set p(value) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'setter: '</span> + value);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>上面两种写法，虽然属性<code>p</code>的读取和赋值行为是一样的，但是有一些细微的区别。第一种写法，属性<code>p</code>的<code>configurable</code>和<code>enumerable</code>都为<code>false</code>，从而导致属性<code>p</code>是不可遍历的；第二种写法，属性<code>p</code>的<code>configurable</code>和<code>enumerable</code>都为<code>true</code>，因此属性<code>p</code>是可遍历的。实际开发中，写法二更常用。</p><p><strong>注意，取值函数<code>get</code>不能接受参数，存值函数<code>set</code>只能接受一个参数（即属性的值）。</strong></p><p>存取器往往用于，属性的值依赖对象内部数据的场合。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj =&#123;</span><br><span class="line">  $n : <span class="number">5</span>,</span><br><span class="line">  get next() &#123; <span class="keyword">return</span> <span class="keyword">this</span>.$n++ &#125;,</span><br><span class="line">  set next(n) &#123;</span><br><span class="line">    <span class="keyword">if</span> (n &gt;= <span class="keyword">this</span>.$n) <span class="keyword">this</span>.$n = n;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'新的值必须大于当前值'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">obj.next <span class="comment">// 5</span></span><br><span class="line"></span><br><span class="line">obj.next = <span class="number">10</span>;</span><br><span class="line">obj.next <span class="comment">// 10</span></span><br><span class="line"></span><br><span class="line">obj.next = <span class="number">5</span>;</span><br><span class="line"><span class="comment">// Uncaught Error: 新的值必须大于当前值</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>next</code>属性的存值函数和取值函数，都依赖于内部属性<code>$n</code>。</p><h2 id="8-对象的拷贝"><a href="#8-对象的拷贝" class="headerlink" title="8.对象的拷贝"></a>8.对象的拷贝</h2><p>有时，我们需要将一个对象的所有属性，拷贝到另一个对象，可以用下面的方法实现。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> extend = <span class="function"><span class="keyword">function</span> (<span class="params">to, from</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> property <span class="keyword">in</span> <span class="keyword">from</span>) &#123;</span><br><span class="line">    to[property] = <span class="keyword">from</span>[property];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> to;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">extend(&#123;&#125;, &#123;</span><br><span class="line">  a: <span class="number">1</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// &#123;a: 1&#125;</span></span><br></pre></td></tr></table></figure><p>上面这个方法的问题在于，如果遇到存取器定义的属性，会只拷贝值。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">extend(&#123;&#125;, &#123;</span><br><span class="line">  get a() &#123; <span class="keyword">return</span> <span class="number">1</span> &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// &#123;a: 1&#125;</span></span><br></pre></td></tr></table></figure><p>为了解决这个问题，我们可以通过<code>Object.defineProperty</code>方法来拷贝属性。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> extend = <span class="function"><span class="keyword">function</span> (<span class="params">to, from</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> property <span class="keyword">in</span> <span class="keyword">from</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">from</span>.hasOwnProperty(property)) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(</span><br><span class="line">      to,</span><br><span class="line">      property,</span><br><span class="line">      <span class="built_in">Object</span>.getOwnPropertyDescriptor(<span class="keyword">from</span>, property)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> to;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">extend(&#123;&#125;, &#123; get a()&#123; <span class="keyword">return</span> <span class="number">1</span> &#125; &#125;)</span><br><span class="line"><span class="comment">// &#123; get a()&#123; return 1 &#125; &#125;)</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>hasOwnProperty</code>那一行用来过滤掉继承的属性，否则可能会报错，因为<code>Object.getOwnPropertyDescriptor</code>读不到继承属性的属性描述对象。</p><h2 id="9-控制对象状态"><a href="#9-控制对象状态" class="headerlink" title="9. 控制对象状态"></a>9. 控制对象状态</h2><p>有时需要冻结对象的读写状态，防止对象被改变。JavaScript 提供了三种冻结方法，最弱的一种是<code>Object.preventExtensions</code>，其次是<code>Object.seal</code>，最强的是<code>Object.freeze</code>。</p><h3 id="9-1-Object-preventExtensions"><a href="#9-1-Object-preventExtensions" class="headerlink" title="9.1 Object.preventExtensions()"></a>9.1 Object.preventExtensions()</h3><p><code>Object.preventExtensions</code>方法可以使得一个对象无法再添加新的属性。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line"><span class="built_in">Object</span>.preventExtensions(obj);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'p'</span>, &#123;</span><br><span class="line">  value: <span class="string">'hello'</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// TypeError: Cannot define property:p, object is not extensible.</span></span><br><span class="line"></span><br><span class="line">obj.p = <span class="number">1</span>;</span><br><span class="line">obj.p <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>obj</code>对象经过<code>Object.preventExtensions</code>以后，就无法添加新属性了。</p><h3 id="9-2-Object-isExtensible"><a href="#9-2-Object-isExtensible" class="headerlink" title="9.2 Object.isExtensible()"></a>9.2 Object.isExtensible()</h3><p><code>Object.isExtensible</code>方法用于检查一个对象是否使用了<code>Object.preventExtensions</code>方法。也就是说，检查是否可以为一个对象添加属性。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.isExtensible(obj) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Object</span>.preventExtensions(obj);</span><br><span class="line"><span class="built_in">Object</span>.isExtensible(obj) <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>上面代码中，对<code>obj</code>对象使用<code>Object.preventExtensions</code>方法以后，再使用<code>Object.isExtensible</code>方法，返回<code>false</code>，表示已经不能添加新属性了。</p><h3 id="9-3-Object-seal"><a href="#9-3-Object-seal" class="headerlink" title="9.3 Object.seal()"></a>9.3 Object.seal()</h3><p><code>Object.seal</code>方法使得一个对象既无法添加新属性，也无法删除旧属性。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">p</span>: <span class="string">'hello'</span> &#125;;</span><br><span class="line"><span class="built_in">Object</span>.seal(obj);</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> obj.p;</span><br><span class="line">obj.p <span class="comment">// "hello"</span></span><br><span class="line"></span><br><span class="line">obj.x = <span class="string">'world'</span>;</span><br><span class="line">obj.x <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>obj</code>对象执行<code>Object.seal</code>方法以后，就无法添加新属性和删除旧属性了。</p><p><code>Object.seal</code>实质是把属性描述对象的<code>configurable</code>属性设为<code>false</code>，因此属性描述对象不再能改变了。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  p: <span class="string">'a'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// seal方法之前</span></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">'p'</span>)</span><br><span class="line"><span class="comment">// Object &#123;</span></span><br><span class="line"><span class="comment">//   value: "a",</span></span><br><span class="line"><span class="comment">//   writable: true,</span></span><br><span class="line"><span class="comment">//   enumerable: true,</span></span><br><span class="line"><span class="comment">//   configurable: true</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.seal(obj);</span><br><span class="line"></span><br><span class="line"><span class="comment">// seal方法之后</span></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">'p'</span>)</span><br><span class="line"><span class="comment">// Object &#123;</span></span><br><span class="line"><span class="comment">//   value: "a",</span></span><br><span class="line"><span class="comment">//   writable: true,</span></span><br><span class="line"><span class="comment">//   enumerable: true,</span></span><br><span class="line"><span class="comment">//   configurable: false</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'p'</span>, &#123;</span><br><span class="line">  enumerable: <span class="literal">false</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// TypeError: Cannot redefine property: p</span></span><br></pre></td></tr></table></figure><p>上面代码中，使用<code>Object.seal</code>方法之后，属性描述对象的<code>configurable</code>属性就变成了<code>false</code>，然后改变<code>enumerable</code>属性就会报错。</p><p><code>Object.seal</code>只是禁止新增或删除属性，并不影响修改某个属性的值。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">p</span>: <span class="string">'a'</span> &#125;;</span><br><span class="line"><span class="built_in">Object</span>.seal(obj);</span><br><span class="line">obj.p = <span class="string">'b'</span>;</span><br><span class="line">obj.p <span class="comment">// 'b'</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>Object.seal</code>方法对<code>p</code>属性的<code>value</code>无效，是因为此时<code>p</code>属性的可写性由<code>writable</code>决定。</p><h3 id="9-4-Object-isSealed"><a href="#9-4-Object-isSealed" class="headerlink" title="9.4 Object.isSealed()"></a>9.4 Object.isSealed()</h3><p><code>Object.isSealed</code>方法用于检查一个对象是否使用了<code>Object.seal</code>方法。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">p</span>: <span class="string">'a'</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.seal(obj);</span><br><span class="line"><span class="built_in">Object</span>.isSealed(obj) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>这时，<code>Object.isExtensible</code>方法也返回<code>false</code>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">p</span>: <span class="string">'a'</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.seal(obj);</span><br><span class="line"><span class="built_in">Object</span>.isExtensible(obj) <span class="comment">// false</span></span><br></pre></td></tr></table></figure><h3 id="9-5-Object-freeze"><a href="#9-5-Object-freeze" class="headerlink" title="9.5 Object.freeze()"></a>9.5 Object.freeze()</h3><p><code>Object.freeze</code>方法可以使得一个对象无法添加新属性、无法删除旧属性、也无法改变属性的值，使得这个对象实际上变成了常量。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  p: <span class="string">'hello'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.freeze(obj);</span><br><span class="line"></span><br><span class="line">obj.p = <span class="string">'world'</span>;</span><br><span class="line">obj.p <span class="comment">// "hello"</span></span><br><span class="line"></span><br><span class="line">obj.t = <span class="string">'hello'</span>;</span><br><span class="line">obj.t <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> obj.p <span class="comment">// false</span></span><br><span class="line">obj.p <span class="comment">// "hello"</span></span><br></pre></td></tr></table></figure><p>上面代码中，对<code>obj</code>对象进行<code>Object.freeze()</code>以后，修改属性、新增属性、删除属性都无效了。这些操作并不报错，只是默默地失败。如果在严格模式下，则会报错。</p><h3 id="9-6-Object-isFrozen"><a href="#9-6-Object-isFrozen" class="headerlink" title="9.6 Object.isFrozen()"></a>9.6 Object.isFrozen()</h3><p><code>Object.isFrozen</code>方法用于检查一个对象是否使用了<code>Object.freeze</code>方法。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  p: <span class="string">'hello'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.freeze(obj);</span><br><span class="line"><span class="built_in">Object</span>.isFrozen(obj) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>使用<code>Object.freeze</code>方法以后，<code>Object.isSealed</code>将会返回<code>true</code>，<code>Object.isExtensible</code>返回<code>false</code>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  p: <span class="string">'hello'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.freeze(obj);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.isSealed(obj) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Object</span>.isExtensible(obj) <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p><code>Object.isFrozen</code>的一个用途是，确认某个对象没有被冻结后，再对它的属性赋值。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  p: <span class="string">'hello'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.freeze(obj);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">Object</span>.isFrozen(obj)) &#123;</span><br><span class="line">  obj.p = <span class="string">'world'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面代码中，确认<code>obj</code>没有被冻结后，再对它的属性赋值，就不会报错了。</p><h3 id="9-7-局限性"><a href="#9-7-局限性" class="headerlink" title="9.7 局限性"></a>9.7 局限性</h3><p>上面的三个方法锁定对象的可写性有一个漏洞：可以通过改变原型对象，来为对象增加属性。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line"><span class="built_in">Object</span>.preventExtensions(obj);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> proto = <span class="built_in">Object</span>.getPrototypeOf(obj);</span><br><span class="line">proto.t = <span class="string">'hello'</span>;</span><br><span class="line">obj.t</span><br><span class="line"><span class="comment">// hello</span></span><br></pre></td></tr></table></figure><p>上面代码中，对象<code>obj</code>本身不能新增属性，但是可以在它的原型对象上新增属性，就依然能够在<code>obj</code>上读到。</p><p>一种解决方案是，把<code>obj</code>的原型也冻结住。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line"><span class="built_in">Object</span>.preventExtensions(obj);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> proto = <span class="built_in">Object</span>.getPrototypeOf(obj);</span><br><span class="line"><span class="built_in">Object</span>.preventExtensions(proto);</span><br><span class="line"></span><br><span class="line">proto.t = <span class="string">'hello'</span>;</span><br><span class="line">obj.t <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>另外一个局限是，如果属性值是对象，上面这些方法只能冻结属性指向的对象，而不能冻结对象本身的内容。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  foo: <span class="number">1</span>,</span><br><span class="line">  bar: [<span class="string">'a'</span>, <span class="string">'b'</span>]</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">Object</span>.freeze(obj);</span><br><span class="line"></span><br><span class="line">obj.bar.push(<span class="string">'c'</span>);</span><br><span class="line">obj.bar <span class="comment">// ["a", "b", "c"]</span></span><br></pre></td></tr></table></figure><p>上面代码中，<code>obj.bar</code>属性指向一个数组，<code>obj</code>对象被冻结以后，这个指向无法改变，即无法指向其他值，但是所指向的数组是可以改变的。</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-概述&quot;&gt;&lt;a href=&quot;#1-概述&quot; class=&quot;headerlink&quot; title=&quot;1.概述&quot;&gt;&lt;/a&gt;1.概述&lt;/h2&gt;&lt;p&gt;JavaScript 提供了一个内部数据结构，用来描述对象的属性，控制它的行为，比如该属性是否可写、可遍历等等。这个内部数据结构称为“属性描述对象”（attributes object）。每个属性都有自己对应的属性描述对象，保存该属性的一些元信息。&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://chrischen0405.github.io/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="http://chrischen0405.github.io/tags/JavaScript/"/>
    
      <category term="Object" scheme="http://chrischen0405.github.io/tags/Object/"/>
    
  </entry>
  
  <entry>
    <title>js判断数据类型，toString() 的应用</title>
    <link href="http://chrischen0405.github.io/2022/01/19/post20220119/"/>
    <id>http://chrischen0405.github.io/2022/01/19/post20220119/</id>
    <published>2022-01-19T10:06:38.000Z</published>
    <updated>2022-09-22T09:52:47.837Z</updated>
    
    <content type="html"><![CDATA[<p><code>Object.prototype.toString</code>方法返回对象的类型字符串，因此可以用来判断一个值的类型：</p><a id="more"></a><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">obj.toString() <span class="comment">// "[object Object]"</span></span><br></pre></td></tr></table></figure><p>上面代码调用空对象的<code>toString</code>方法，结果返回一个字符串<code>object Object</code>，其中第二个<code>Object</code>表示该值的构造函数。这是一个十分有用的判断数据类型的方法。</p><p>由于实例对象可能会自定义<code>toString</code>方法，覆盖掉<code>Object.prototype.toString</code>方法，所以为了得到类型字符串，最好直接使用<code>Object.prototype.toString</code>方法。通过函数的<code>call</code>方法，可以在任意值上调用这个方法，帮助我们判断这个值的类型：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype.toString.call(value)</span><br></pre></td></tr></table></figure></p><p>上面代码表示对<code>value</code>这个值调用<code>Object.prototype.toString</code>方法。</p><p>不同数据类型的<code>Object.prototype.toString</code>方法返回值如下。</p><ul><li>数值：返回<code>[object Number]</code>。</li><li>字符串：返回<code>[object String]</code>。</li><li>布尔值：返回<code>[object Boolean]</code>。</li><li>undefined：返回<code>[object Undefined]</code>。</li><li>null：返回<code>[object Null]</code>。</li><li>数组：返回<code>[object Array]</code>。</li><li>arguments 对象：返回<code>[object Arguments]</code>。</li><li>函数：返回<code>[object Function]</code>。</li><li>Error 对象：返回<code>[object Error]</code>。</li><li>Date 对象：返回<code>[object Date]</code>。</li><li>RegExp 对象：返回<code>[object RegExp]</code>。</li><li>其他对象：返回<code>[object Object]</code>。</li></ul><p>这就是说，<code>Object.prototype.toString</code>可以看出一个值到底是什么类型：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="number">2</span>) <span class="comment">// "[object Number]"</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="string">''</span>) <span class="comment">// "[object String]"</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="literal">true</span>) <span class="comment">// "[object Boolean]"</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="literal">undefined</span>) <span class="comment">// "[object Undefined]"</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="literal">null</span>) <span class="comment">// "[object Null]"</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="built_in">Math</span>) <span class="comment">// "[object Math]"</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(&#123;&#125;) <span class="comment">// "[object Object]"</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call([]) <span class="comment">// "[object Array]"</span></span><br></pre></td></tr></table></figure></p><p>利用这个特性，可以写出一个比<code>typeof</code>运算符更准确的类型判断函数：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> type = <span class="function"><span class="keyword">function</span> (<span class="params">o</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> s = <span class="built_in">Object</span>.prototype.toString.call(o);</span><br><span class="line">  <span class="keyword">return</span> s.match(<span class="regexp">/\[object (.*?)\]/</span>)[<span class="number">1</span>].toLowerCase();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">type(&#123;&#125;); <span class="comment">// "object"</span></span><br><span class="line">type([]); <span class="comment">// "array"</span></span><br><span class="line">type(<span class="number">5</span>); <span class="comment">// "number"</span></span><br><span class="line">type(<span class="literal">null</span>); <span class="comment">// "null"</span></span><br><span class="line">type(); <span class="comment">// "undefined"</span></span><br><span class="line">type(<span class="regexp">/abcd/</span>); <span class="comment">// "regex"</span></span><br><span class="line">type(<span class="keyword">new</span> <span class="built_in">Date</span>()); <span class="comment">// "date"</span></span><br></pre></td></tr></table></figure></p><p>在上面这个<code>type</code>函数的基础上，还可以加上专门判断某种类型数据的方法：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> type = <span class="function"><span class="keyword">function</span> (<span class="params">o</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> s = <span class="built_in">Object</span>.prototype.toString.call(o);</span><br><span class="line">  <span class="keyword">return</span> s.match(<span class="regexp">/\[object (.*?)\]/</span>)[<span class="number">1</span>].toLowerCase();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">[<span class="string">'Null'</span>,</span><br><span class="line"> <span class="string">'Undefined'</span>,</span><br><span class="line"> <span class="string">'Object'</span>,</span><br><span class="line"> <span class="string">'Array'</span>,</span><br><span class="line"> <span class="string">'String'</span>,</span><br><span class="line"> <span class="string">'Number'</span>,</span><br><span class="line"> <span class="string">'Boolean'</span>,</span><br><span class="line"> <span class="string">'Function'</span>,</span><br><span class="line"> <span class="string">'RegExp'</span></span><br><span class="line">].forEach(<span class="function"><span class="keyword">function</span> (<span class="params">t</span>) </span>&#123;</span><br><span class="line">  type[<span class="string">'is'</span> + t] = <span class="function"><span class="keyword">function</span> (<span class="params">o</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> type(o) === t.toLowerCase();</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">type.isObject(&#123;&#125;) <span class="comment">// true</span></span><br><span class="line">type.isNumber(<span class="literal">NaN</span>) <span class="comment">// true</span></span><br><span class="line">type.isRegExp(<span class="regexp">/abc/</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure></p><p>转自<a href="https://wangdoc.com/javascript/stdlib/object.html#tostring-%E7%9A%84%E5%BA%94%E7%94%A8%E5%88%A4%E6%96%AD%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B" target="_blank" rel="noopener">《toString() 的应用：判断数据类型》</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;Object.prototype.toString&lt;/code&gt;方法返回对象的类型字符串，因此可以用来判断一个值的类型：&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://chrischen0405.github.io/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="http://chrischen0405.github.io/tags/JavaScript/"/>
    
      <category term="函数" scheme="http://chrischen0405.github.io/tags/%E5%87%BD%E6%95%B0/"/>
    
      <category term="toString" scheme="http://chrischen0405.github.io/tags/toString/"/>
    
  </entry>
  
  <entry>
    <title>js中map()方法是否改变原数组</title>
    <link href="http://chrischen0405.github.io/2022/01/18/post20220118/"/>
    <id>http://chrischen0405.github.io/2022/01/18/post20220118/</id>
    <published>2022-01-18T08:40:41.000Z</published>
    <updated>2022-09-22T09:50:32.328Z</updated>
    
    <content type="html"><![CDATA[<p>先说结论：<strong>当数组元素是基本数据类型时，<code>map()</code>方法不会改变原数组；当数组元素是引用类型时，<code>map()</code>方法会改变原数组。</strong></p><a id="more"></a><h2 id="定义和用法"><a href="#定义和用法" class="headerlink" title="定义和用法"></a>定义和用法</h2><p>map() 方法返回一个新数组，数组中的元素为原始数组元素调用函数处理后的值。<br>map() 方法按照原始数组元素顺序依次处理元素。<br><strong>注意：</strong> map() 不会对空数组进行检测。<br><strong>注意：</strong> map() 不会改变原始数组。</p><h2 id="发现问题"><a href="#发现问题" class="headerlink" title="发现问题"></a>发现问题</h2><p>数组元素为基本数据类型时使用<code>map()</code>方法：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 基本数据类型</span></span><br><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">const</span> newArr = arr.map(<span class="function"><span class="params">item</span> =&gt;</span>  item * <span class="number">2</span>)</span><br><span class="line"><span class="built_in">console</span>.log(arr) <span class="comment">// [ 1, 2, 3 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(newArr) <span class="comment">// [ 2, 4, 6 ]</span></span><br></pre></td></tr></table></figure></p><p>数组元素为引用数据类型时使用<code>map()</code>方法：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 基本数据类型</span></span><br><span class="line"><span class="keyword">const</span> arr = [&#123;</span><br><span class="line">    name: <span class="string">'a'</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">    name: <span class="string">'b'</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">    name: <span class="string">'c'</span></span><br><span class="line">&#125;]</span><br><span class="line"><span class="keyword">const</span> newArr = arr.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    item.age = <span class="number">10</span></span><br><span class="line">    <span class="keyword">return</span> item</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(arr)</span><br><span class="line"><span class="comment">// [ &#123; name: 'a', age: 10 &#125;, &#123; name: 'b', age: 10 &#125;, &#123; name: 'c', age: 10 &#125; ]</span></span><br><span class="line"><span class="built_in">console</span>.log(newArr)</span><br><span class="line"><span class="comment">// [ &#123; name: 'a', age: 10 &#125;, &#123; name: 'b', age: 10 &#125;, &#123; name: 'c', age: 10 &#125; ]</span></span><br></pre></td></tr></table></figure></p><p>可以看到数组元素为对象时使用<code>map()</code>方法后原数组也跟着变化了，原因是因为<strong>基本类型传值是复制，引用类型传值是引用</strong></p><h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><p>比如数组元素为对象时<code>map()</code>方法中处理函数就返回一个新的对象：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [&#123;</span><br><span class="line">    name: <span class="string">'a'</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">    name: <span class="string">'b'</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">    name: <span class="string">'c'</span></span><br><span class="line">&#125;]</span><br><span class="line"><span class="keyword">const</span> newArr = arr.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        ...item,</span><br><span class="line">        age: <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(arr)</span><br><span class="line"><span class="comment">// [ &#123; name: 'a' &#125;, &#123; name: 'b' &#125;, &#123; name: 'c' &#125; ]</span></span><br><span class="line"><span class="built_in">console</span>.log(newArr)</span><br><span class="line"><span class="comment">// [ &#123; name: 'a', age: 10 &#125;, &#123; name: 'b', age: 10 &#125;, &#123; name: 'c', age: 10 &#125; ]</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;先说结论：&lt;strong&gt;当数组元素是基本数据类型时，&lt;code&gt;map()&lt;/code&gt;方法不会改变原数组；当数组元素是引用类型时，&lt;code&gt;map()&lt;/code&gt;方法会改变原数组。&lt;/strong&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://chrischen0405.github.io/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="http://chrischen0405.github.io/tags/JavaScript/"/>
    
      <category term="函数" scheme="http://chrischen0405.github.io/tags/%E5%87%BD%E6%95%B0/"/>
    
      <category term="map" scheme="http://chrischen0405.github.io/tags/map/"/>
    
      <category term="数组" scheme="http://chrischen0405.github.io/tags/%E6%95%B0%E7%BB%84/"/>
    
  </entry>
  
  <entry>
    <title>uniapp开发微信小程序安卓机获取位置失效</title>
    <link href="http://chrischen0405.github.io/2021/12/28/post20211228/"/>
    <id>http://chrischen0405.github.io/2021/12/28/post20211228/</id>
    <published>2021-12-28T08:54:10.000Z</published>
    <updated>2022-09-22T09:48:00.376Z</updated>
    
    <content type="html"><![CDATA[<p>使用uniapp开发微信小程序，在使用<code>uni.chooseLocation</code>方法获取位置信息时，IOS系统真机下可以正常获取位置信息，但是使用安卓真机时获取位置信息方法失效，并且也不报错没有任何反应，解决办法如下：</p><a id="more"></a><ul><li>使用Hbuilder开发工具的话，在<code>manifest.json</code>文件的微信小程序配置下勾上位置接口权限：</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/13924215-3a5b7790bac1c630.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="微信小程序配置"></p><ul><li>使用别的开发工具或者源码模式底下，直接在<code>manifest.json</code>文件中找到<code>mp-weixin</code>的配置项，在<code>permission</code>底下加上<code>scope.userLocation</code>位置接口权限，如下：</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/* 小程序特有相关 */</span><br><span class="line">"mp-weixin" : &#123;</span><br><span class="line">        "appid" : "",</span><br><span class="line">        "setting" : &#123;</span><br><span class="line">            "urlCheck" : false,</span><br><span class="line">            "es6" : false,</span><br><span class="line">            "postcss" : false,</span><br><span class="line">            "minified" : true</span><br><span class="line">        &#125;,</span><br><span class="line">        "usingComponents" : true,</span><br><span class="line">        "permission" : &#123;  // 在这里加权限</span><br><span class="line">            "scope.userLocation" : &#123;</span><br><span class="line">                "desc" : "XXX" // 必填</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><p>在编译成微信小程序以后，可以看到小程序项目底下的<code>app.json</code>文件中的<code>permission</code>底下有了位置接口权限：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">"permission": &#123;</span><br><span class="line">    "scope.userLocation": &#123;</span><br><span class="line">      "desc": "XXX"</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure></p><p>然后安卓真机便可以使用<code>chooseLocation</code>方法获取位置信息了。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;使用uniapp开发微信小程序，在使用&lt;code&gt;uni.chooseLocation&lt;/code&gt;方法获取位置信息时，IOS系统真机下可以正常获取位置信息，但是使用安卓真机时获取位置信息方法失效，并且也不报错没有任何反应，解决办法如下：&lt;/p&gt;
    
    </summary>
    
      <category term="uni-app" scheme="http://chrischen0405.github.io/categories/uni-app/"/>
    
    
      <category term="微信小程序" scheme="http://chrischen0405.github.io/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
      <category term="小程序" scheme="http://chrischen0405.github.io/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
      <category term="uni-app" scheme="http://chrischen0405.github.io/tags/uni-app/"/>
    
      <category term="安卓" scheme="http://chrischen0405.github.io/tags/%E5%AE%89%E5%8D%93/"/>
    
      <category term="位置" scheme="http://chrischen0405.github.io/tags/%E4%BD%8D%E7%BD%AE/"/>
    
  </entry>
  
  <entry>
    <title>uniapp编译成微信小程序背景图片失效</title>
    <link href="http://chrischen0405.github.io/2021/11/26/post20211126/"/>
    <id>http://chrischen0405.github.io/2021/11/26/post20211126/</id>
    <published>2021-11-26T08:07:29.000Z</published>
    <updated>2022-09-22T09:45:46.462Z</updated>
    
    <content type="html"><![CDATA[<p>在uniapp中给元素样式加上图片背景，编译成h5正常，但是编译成微信小程序以后背景图片失效：</p><a id="more"></a><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">background</span>: url(<span class="string">'/static/img/bg.png'</span>);</span><br></pre></td></tr></table></figure><p>解决办法是把背景图片的图片路径改成<code>base64</code>编码：<br><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">background</span>: url(data:image/png;base64,xxxxxx);</span><br></pre></td></tr></table></figure></p><p>使用<code>base64</code>编码的背景图片在微信小程序也可以正常显示了，接下来直接把<code>base64</code>编码写在页面文件中太难看了，改成全局css变量，方便替换和全局调用。</p><p>1、新建一个<code>scss</code>文件用来存放变量：<br><img src="https://upload-images.jianshu.io/upload_images/13924215-9eecd7f89b0c6336.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="base64-pic-store.scss"><br>2、把<code>base64-pic-store.scss</code>里面的<code>$background-base64-code</code>变量赋值为背景图片的<code>base64</code>编码：<br><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 背景图base64编码</span></span><br><span class="line"><span class="variable">$background-base64-code</span>: url(data:image/png;base64,xxxxxx);</span><br></pre></td></tr></table></figure></p><p>3、在项目根目录底下的<code>uni.scss</code>文件里引入我们的变量scss文件，用于全局可调用：<br><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 引入变量文件 */</span></span><br><span class="line">@<span class="keyword">import</span> <span class="string">"@/common/css/base64-pic-store.scss"</span>;</span><br></pre></td></tr></table></figure></p><p>4、在需要调用背景图片的地方调用全局变量：<br><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">background</span>: <span class="variable">$background-base64-code</span>;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在uniapp中给元素样式加上图片背景，编译成h5正常，但是编译成微信小程序以后背景图片失效：&lt;/p&gt;
    
    </summary>
    
      <category term="uni-app" scheme="http://chrischen0405.github.io/categories/uni-app/"/>
    
    
      <category term="微信小程序" scheme="http://chrischen0405.github.io/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
      <category term="小程序" scheme="http://chrischen0405.github.io/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
      <category term="uni-app" scheme="http://chrischen0405.github.io/tags/uni-app/"/>
    
  </entry>
  
  <entry>
    <title>windows下更换node版本</title>
    <link href="http://chrischen0405.github.io/2021/08/25/post20210825/"/>
    <id>http://chrischen0405.github.io/2021/08/25/post20210825/</id>
    <published>2021-08-25T09:42:31.000Z</published>
    <updated>2022-09-22T09:43:10.112Z</updated>
    
    <content type="html"><![CDATA[<p>Windows环境下可以使用nvm来更换nodejs版本，下面介绍使用方法以及使用中遇到的问题：</p><a id="more"></a><h1 id="1-安装nvm"><a href="#1-安装nvm" class="headerlink" title="1 安装nvm"></a>1 安装nvm</h1><p>下载地址：<a href="https://github.com/coreybutler/nvm-windows/releases" target="_blank" rel="noopener">https://github.com/coreybutler/nvm-windows/releases</a></p><p><img src="https://upload-images.jianshu.io/upload_images/13924215-432314de65b577c2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="nvm-setup.zip"></p><p>下载完解压以后里面有个exe文件进行默认安装</p><h1 id="2-配置淘宝镜像"><a href="#2-配置淘宝镜像" class="headerlink" title="2 配置淘宝镜像"></a>2 配置淘宝镜像</h1><p>依次打开：C:\ &gt; Users &gt; 你用户名命名的文件夹  &gt; AppData &gt; Roaming &gt; nvm &gt; settings.txt</p><p>在settings.txt文件里新增两行配置taobao镜像地址：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node_mirror: https://npm.taobao.org/mirrors/node/</span><br><span class="line">npm_mirror: https://npm.taobao.org/mirrors/npm/</span><br></pre></td></tr></table></figure><p>保存关闭</p><h1 id="3-使用nvm"><a href="#3-使用nvm" class="headerlink" title="3 使用nvm"></a>3 使用nvm</h1><p>1） 安装完成以后打开命令行，使用<code>nvm list</code>命令查看已有node版本，以及当前使用node版本：</p><p><img src="https://upload-images.jianshu.io/upload_images/13924215-ae03142d45a8a7ca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="nvm list"></p><p>2） 使用<code>nvm install 13</code>命令来安装node 13.0.0版本：</p><p><img src="https://upload-images.jianshu.io/upload_images/13924215-40b38da377338081.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="nvm install"></p><p>3） 使用<code>nvm list</code>查看新安装的node：</p><p><img src="https://upload-images.jianshu.io/upload_images/13924215-2d5177fa812900a6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="nvm list"></p><p>4） 使用<code>nvm use 13</code>来使用13.0.0版本的node：</p><p><img src="https://upload-images.jianshu.io/upload_images/13924215-8e36e55d6518b4a0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="nvm use"></p><p>5) 使用<code>nvm list</code>查看是否切换成功，再使用<code>node -v</code>查看是否成功切换node版本：</p><p><img src="https://upload-images.jianshu.io/upload_images/13924215-915b3380e506c916.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="切换成功"></p><h1 id="4-nvm命令"><a href="#4-nvm命令" class="headerlink" title="4 nvm命令"></a>4 nvm命令</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nvm list // 查看已安装node版本</span><br><span class="line">nvm install xxx // 安装对应xxx版本的node</span><br><span class="line">nvm uninstall xxx // 卸载对应xxx版本的node</span><br><span class="line">nvm use xxx // 使用对应xxx版本的node</span><br></pre></td></tr></table></figure><h1 id="5-nvm使用中遇到的问题"><a href="#5-nvm使用中遇到的问题" class="headerlink" title="5 nvm使用中遇到的问题"></a>5 nvm使用中遇到的问题</h1><h2 id="5-1-nvm切换node失效的问题"><a href="#5-1-nvm切换node失效的问题" class="headerlink" title="5.1 nvm切换node失效的问题"></a>5.1 nvm切换node失效的问题</h2><p>问题描述：我原本就已经安装了node，然后使用nvm安装了其他版本的node，切换以后使用<code>nvm use</code>正常显示，使用<code>node -v</code>还是原来的node版本。  </p><p>解决办法：要把先安装的node卸载，然后使用nvm进行node版本控制就可以了。</p><h2 id="5-2-切换node版本以后前端项目无法启动"><a href="#5-2-切换node版本以后前端项目无法启动" class="headerlink" title="5.2 切换node版本以后前端项目无法启动"></a>5.2 切换node版本以后前端项目无法启动</h2><p>问题描述：  切换完node版本以后，<code>npm run dev</code>发现项目启动报错了：<code>【nodeJs】This usually happens because your environment has changed since running &#39;npm install&#39;</code>，这是因为运行npm安装后环境发生了变化。</p><p>解决办法：先运行<code>npm install node-sass</code>，再运行<code>npm rebuild node-sass</code>命令</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Windows环境下可以使用nvm来更换nodejs版本，下面介绍使用方法以及使用中遇到的问题：&lt;/p&gt;
    
    </summary>
    
      <category term="node" scheme="http://chrischen0405.github.io/categories/node/"/>
    
    
      <category term="npm" scheme="http://chrischen0405.github.io/tags/npm/"/>
    
      <category term="node" scheme="http://chrischen0405.github.io/tags/node/"/>
    
      <category term="nvm" scheme="http://chrischen0405.github.io/tags/nvm/"/>
    
      <category term="windows" scheme="http://chrischen0405.github.io/tags/windows/"/>
    
      <category term="版本" scheme="http://chrischen0405.github.io/tags/%E7%89%88%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>Vue组件/实例的选项的顺序推荐</title>
    <link href="http://chrischen0405.github.io/2021/06/11/post20210611/"/>
    <id>http://chrischen0405.github.io/2021/06/11/post20210611/</id>
    <published>2021-06-11T03:41:56.000Z</published>
    <updated>2022-09-22T09:40:52.362Z</updated>
    
    <content type="html"><![CDATA[<p><strong>组件/实例的选项应该有统一的顺序。</strong><a href="&#39;https://cn.vuejs.org/v2/style-guide/#%E7%BB%84%E4%BB%B6-%E5%AE%9E%E4%BE%8B%E7%9A%84%E9%80%89%E9%A1%B9%E7%9A%84%E9%A1%BA%E5%BA%8F%E6%8E%A8%E8%8D%90&#39;">Vue.js文档</a>中推荐的组件/实例选项顺序推荐：</p><a id="more"></a><ol><li><p><strong>副作用</strong> (触发组件外的影响)</p><ul><li><code>el</code></li></ul></li><li><p><strong>全局感知</strong> (要求组件以外的知识)</p><ul><li><code>name</code></li><li><code>parent</code></li></ul></li><li><p><strong>组件类型</strong> (更改组件的类型)</p><ul><li><code>functional</code></li></ul></li><li><p><strong>模板修改器</strong> (改变模板的编译方式)</p><ul><li><code>delimiters</code></li><li><code>comments</code></li></ul></li><li><p><strong>模板依赖</strong> (模板内使用的资源)</p><ul><li><code>components</code></li><li><code>directives</code></li><li><code>filters</code></li></ul></li><li><p><strong>组合</strong> (向选项里合并 property)</p><ul><li><code>extends</code></li><li><code>mixins</code></li></ul></li><li><p><strong>接口</strong> (组件的接口)</p><ul><li><code>inheritAttrs</code></li><li><code>model</code></li><li><code>props</code>/<code>propsData</code></li></ul></li><li><p><strong>本地状态</strong> (本地的响应式 property)</p><ul><li><code>data</code></li><li><code>computed</code></li></ul></li><li><p><strong>事件</strong> (通过响应式事件触发的回调)</p><ul><li><code>watch</code></li><li>生命周期钩子 (按照它们被调用的顺序)<ul><li><code>beforeCreate</code></li><li><code>created</code></li><li><code>beforeMount</code></li><li><code>mounted</code></li><li><code>beforeUpdate</code></li><li><code>updated</code></li><li><code>activated</code></li><li><code>deactivated</code></li><li><code>beforeDestroy</code></li><li><code>destroyed</code></li></ul></li></ul></li><li><p><strong>非响应式的 property</strong> (不依赖响应系统的实例 property)</p><ul><li><code>methods</code></li></ul></li><li><p><strong>渲染</strong> (组件输出的声明式描述)</p><ul><li><code>template</code>/<code>render</code></li><li><code>renderError</code></li></ul></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;组件/实例的选项应该有统一的顺序。&lt;/strong&gt;&lt;a href=&quot;&amp;#39;https://cn.vuejs.org/v2/style-guide/#%E7%BB%84%E4%BB%B6-%E5%AE%9E%E4%BE%8B%E7%9A%84%E9%80%89%E9%A1%B9%E7%9A%84%E9%A1%BA%E5%BA%8F%E6%8E%A8%E8%8D%90&amp;#39;&quot;&gt;Vue.js文档&lt;/a&gt;中推荐的组件/实例选项顺序推荐：&lt;/p&gt;
    
    </summary>
    
      <category term="Vue" scheme="http://chrischen0405.github.io/categories/Vue/"/>
    
    
      <category term="Vue" scheme="http://chrischen0405.github.io/tags/Vue/"/>
    
      <category term="组件" scheme="http://chrischen0405.github.io/tags/%E7%BB%84%E4%BB%B6/"/>
    
      <category term="文档" scheme="http://chrischen0405.github.io/tags/%E6%96%87%E6%A1%A3/"/>
    
  </entry>
  
  <entry>
    <title>Do not access Object.prototype method &#39;hasOwnProperty&#39; from target object no-prototype-builtins</title>
    <link href="http://chrischen0405.github.io/2021/05/12/post20210512/"/>
    <id>http://chrischen0405.github.io/2021/05/12/post20210512/</id>
    <published>2021-05-12T06:46:24.000Z</published>
    <updated>2022-09-22T09:38:29.281Z</updated>
    
    <content type="html"><![CDATA[<p>今天使用对象方法<code>hasOwnProperty</code>时，<code>ESLint</code>报了如下错误：</p><a id="more"></a><p><img src="https://upload-images.jianshu.io/upload_images/13924215-1b16b0a638143e6c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Do not access Object.prototype method &#39;hasOwnProperty&#39; from target object no-prototype-builtins"><br>上述文字字面意思是：“不要从目标对象访问 Object 原型方法”，一种解决办法是用<code>call</code>改变指向调用：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype.hasOwnProperty.call(obj, <span class="string">'key'</span>)</span><br></pre></td></tr></table></figure></p><p>这是新版本的<code>ESLint</code>使用了禁止直接调用<code>Object.prototypes</code>的内置属性开关，说白了就是<code>ESLint</code>配置文件中的<code>&quot;extends&quot;: &quot;eslint:recommended&quot;</code>属性启用了此规则。</p><p>在<code>ECMAScript 5.1</code>中，新增了<code>Object.create</code>，它支持使用指定的<code>[[Prototype]]</code>创建对象。<code>Object.create(null)</code>是一种常见的模式，用于创建将用作映射的对象。当假定对象将包含来自<code>Object.prototype</code>的属性时，这可能会导致错误。该规则防止直接从一个对象调用某些<code>Object.prototype</code>的方法。</p><p>此外，对象可以具有属性，这些属性可以将<code>Object.prototype</code>的内建函数隐藏，可能导致意外行为或拒绝服务安全漏洞。例如，web服务器解析来自客户机的JSON输入并直接在结果对象上调用<code>hasOwnProperty</code>是不安全的，因为恶意客户机可能发送一个JSON值，如<code>{&quot;hasOwnProperty&quot;: 1}</code>，并导致服务器崩溃。</p><p>为了避免这种细微的bug，最好总是从<code>Object.prototype</code>调用这些方法。例如，<code>foo.hasOwnProperty(&quot;bar&quot;)</code>应该替换为<code>Object.prototype.hasOwnProperty.call(foo, &quot;bar&quot;)</code>。<br>参考地址：<a href="https://www.cnblogs.com/superclound/p/12202576.html" target="_blank" rel="noopener">https://www.cnblogs.com/superclound/p/12202576.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;今天使用对象方法&lt;code&gt;hasOwnProperty&lt;/code&gt;时，&lt;code&gt;ESLint&lt;/code&gt;报了如下错误：&lt;/p&gt;
    
    </summary>
    
      <category term="踩坑" scheme="http://chrischen0405.github.io/categories/%E8%B8%A9%E5%9D%91/"/>
    
    
      <category term="JavaScript" scheme="http://chrischen0405.github.io/tags/JavaScript/"/>
    
      <category term="call" scheme="http://chrischen0405.github.io/tags/call/"/>
    
      <category term="报错" scheme="http://chrischen0405.github.io/tags/%E6%8A%A5%E9%94%99/"/>
    
      <category term="ESLint" scheme="http://chrischen0405.github.io/tags/ESLint/"/>
    
      <category term="Object" scheme="http://chrischen0405.github.io/tags/Object/"/>
    
  </entry>
  
  <entry>
    <title>Vuex学习笔记</title>
    <link href="http://chrischen0405.github.io/2021/04/09/post20210409/"/>
    <id>http://chrischen0405.github.io/2021/04/09/post20210409/</id>
    <published>2021-04-09T08:05:17.000Z</published>
    <updated>2022-09-22T09:38:29.278Z</updated>
    
    <content type="html"><![CDATA[<p>用了好久<code>vuex</code>没有记录过，重新再学一遍并做一下笔记。</p><a id="more"></a><h1 id="1-Vuex概述"><a href="#1-Vuex概述" class="headerlink" title="1 Vuex概述"></a>1 Vuex概述</h1><h2 id="1-1-组件之间共享数据的方式"><a href="#1-1-组件之间共享数据的方式" class="headerlink" title="1.1 组件之间共享数据的方式"></a>1.1 组件之间共享数据的方式</h2><p>父向子传值：<code>v-bind</code> 属性绑定<br>子向父传值：<code>v-on</code> 事件绑定<br>兄弟组件传值： <code>EventBus</code></p><ul><li><code>$on</code> 接收数据的组件</li><li><code>$emit</code> 发送数据的组件</li></ul><h2 id="1-2-Vuex是什么"><a href="#1-2-Vuex是什么" class="headerlink" title="1.2 Vuex是什么"></a>1.2 Vuex是什么</h2><p><code>Vuex</code>是实现组件全局状态（数据）管理的一种机制，可以方便的实现组件之间数据的共享。</p><h2 id="1-3-使用Vuex的好处"><a href="#1-3-使用Vuex的好处" class="headerlink" title="1.3 使用Vuex的好处"></a>1.3 使用Vuex的好处</h2><ul><li>能够在<code>vuex</code>中集中管理共享的数据，方便开发和维护</li><li>能够高效实现组件之间数据共享，提高开发效率</li><li>存储在<code>vuex</code>中的数据都是响应式的，能够实时保持数据与页面的同步</li></ul><h2 id="1-4-什么样的数据适合存储到Vuex中"><a href="#1-4-什么样的数据适合存储到Vuex中" class="headerlink" title="1.4 什么样的数据适合存储到Vuex中"></a>1.4 什么样的数据适合存储到Vuex中</h2><p>一般情况向下，只有组件间共享的内容才存储到<code>vuex</code>中，对于组件中的私有数据，依旧存储在组件自身的<code>data</code>中</p><h1 id="2-Vuex的基本使用"><a href="#2-Vuex的基本使用" class="headerlink" title="2 Vuex的基本使用"></a>2 Vuex的基本使用</h1><h2 id="2-1-安装vuex依赖包"><a href="#2-1-安装vuex依赖包" class="headerlink" title="2.1 安装vuex依赖包"></a>2.1 安装vuex依赖包</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vuex --save</span><br></pre></td></tr></table></figure><h2 id="2-2-导入vuex包"><a href="#2-2-导入vuex包" class="headerlink" title="2.2 导入vuex包"></a>2.2 导入vuex包</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"><span class="comment">//挂载Vuex</span></span><br><span class="line">Vue.use(Vuex)</span><br></pre></td></tr></table></figure><h2 id="2-3-创建store对象"><a href="#2-3-创建store对象" class="headerlink" title="2.3 创建store对象"></a>2.3 创建store对象</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建VueX对象</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">    state: &#123;</span><br><span class="line">        <span class="comment">//存放的键值对就是所要管理的状态</span></span><br><span class="line">        name: <span class="string">'helloVueX'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="2-4-将store对象挂载到vue实例中"><a href="#2-4-将store对象挂载到vue实例中" class="headerlink" title="2.4 将store对象挂载到vue实例中"></a>2.4 将store对象挂载到vue实例中</h2><p>在根目录底下的<code>main.js</code>的文件中：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store'</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  <span class="comment">// 将创建的数据共享对象挂载到这个vue实例中</span></span><br><span class="line">  store,</span><br><span class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><h1 id="3-Vuex核心概念"><a href="#3-Vuex核心概念" class="headerlink" title="3 Vuex核心概念"></a>3 Vuex核心概念</h1><h2 id="3-1-State"><a href="#3-1-State" class="headerlink" title="3.1 State"></a>3.1 State</h2><p><code>State</code>提供唯一的公共数据源，所有共享的数据源都要统一放到<code>Store</code>的<code>State</code>中进行存储。<br>组件访问<code>State</code>中数据方式：</p><h3 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$store.state.全局数据名称</span><br></pre></td></tr></table></figure><h3 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从vuex中按需导入mapState</span></span><br><span class="line"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">'vuex'</span></span><br></pre></td></tr></table></figure><p>通过导入的<code>mapState</code>函数，将当前函数需要的全局数据，映射为当前组件的<code>computed</code>计算属性：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  ...mapState([<span class="string">'name'</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>然后在当前组件就可以直接使用<code>this.name</code></p><h2 id="3-2-Mutation"><a href="#3-2-Mutation" class="headerlink" title="3.2 Mutation"></a>3.2 Mutation</h2><p><code>Mutation</code>用于变更<code>Store</code>中的数据。</p><ul><li>只能通过<code>Mutation</code>变更<code>Store</code>中的数据，不可以直接操作<code>Store</code>中的数据。</li><li>操作虽然繁琐，但是可以集中监控所有数据的变化。</li><li><code>Mutations</code>中<strong>不能执行异步操作</strong>。<h3 id="mutations使用方法"><a href="#mutations使用方法" class="headerlink" title="mutations使用方法"></a>mutations使用方法</h3><code>mutations</code>方法都有默认的形参：<br>([state] [,payload])</li><li><code>state</code>是当前<code>vuex</code>对象中的<code>state</code></li><li><code>payload</code>是该方法在被调用时传递参数使用的</li></ul><p>定义<code>Mutation</code>：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">    state: &#123;</span><br><span class="line">        name: <span class="string">'helloVueX'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    mutations: &#123;</span><br><span class="line">        edit (state, name) &#123;</span><br><span class="line">            <span class="comment">// 变更状态</span></span><br><span class="line">            state.name = name</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><h4 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h4><p>在组件中使用<code>commit</code>函数调用这个<code>mutation</code>：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$store.commit(<span class="string">'edit'</span>, <span class="string">'111'</span>)</span><br></pre></td></tr></table></figure></p><h4 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从vuex中按需导入mapMutitions</span></span><br><span class="line"><span class="keyword">import</span> &#123; mapMutations &#125; <span class="keyword">from</span> <span class="string">'vuex'</span></span><br></pre></td></tr></table></figure><p>通过导入的<code>mapMutations</code>函数，将需要的<code>mutations</code>函数映射为当前组件的<code>methods</code>方法：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  ...mapMutations([<span class="string">'edit'</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>然后在当前组件可以直接调用方法<code>this.edit(&#39;111&#39;)</code></p><h2 id="3-3-Action"><a href="#3-3-Action" class="headerlink" title="3.3 Action"></a>3.3 Action</h2><p><code>Action</code>用于处理异步任务。<br>如果通过异步操作变更数据，必须使用<code>Action</code>，而不能使用<code>Mutation</code>，但是在<code>Action</code>中还是要通过触发<code>Mutation</code>的方式间接变更数据。</p><h3 id="actions使用方法"><a href="#actions使用方法" class="headerlink" title="actions使用方法"></a>actions使用方法</h3><p><code>Actions</code>中的方法有两个默认参数：<br>([context] [,payload])</p><ul><li><code>context</code> 上下文对象</li><li><code>payload</code> 挂载参数</li></ul><p>比如执行<code>setTimeout</code>异步操作：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">actions:&#123;</span><br><span class="line">    aEdit(context, payload) &#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// 只有mutations中定义的函数才有权利修改state中的数据</span></span><br><span class="line">            context.commit(<span class="string">'edit'</span>, payload)</span><br><span class="line">        &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="方法一-1"><a href="#方法一-1" class="headerlink" title="方法一"></a>方法一</h4><p>在组件中调用异步方法，使用<code>dispatch</code>函数来触发<code>action</code>：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$store.dispatch(<span class="string">'aEdit'</span>, <span class="string">'111'</span>)</span><br></pre></td></tr></table></figure></p><h4 id="方法二-1"><a href="#方法二-1" class="headerlink" title="方法二"></a>方法二</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从vuex中按需导入mapActions</span></span><br><span class="line"><span class="keyword">import</span> &#123; mapActions &#125; <span class="keyword">from</span> <span class="string">'vuex'</span></span><br></pre></td></tr></table></figure><p>通过导入的<code>mapActions</code>函数，将需要的<code>actions</code>函数映射为当前组件的<code>methods</code>方法：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  ...mapActions([<span class="string">'aEdit'</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>然后在当前组件可以直接调用方法<code>this.aEdit(&#39;111&#39;)</code></p><h2 id="3-4-Getter"><a href="#3-4-Getter" class="headerlink" title="3.4 Getter"></a>3.4 Getter</h2><p><code>Getter</code>用于对<code>Store</code>中的数据进行加工处理形成新的数据。</p><ul><li><code>Getter</code>可以对<code>Store</code>中已有的数据进行加工处理之后形成新的数据，类似<code>Vue</code>的计算属性。</li><li><code>Store</code>中的数据发生变化，<code>Getter</code>中的数据也会发生变化。</li><li><code>Getter</code>中的数据处理不会修改<code>State</code>中的数据，只起到包装的作用。<h3 id="Getters使用方法"><a href="#Getters使用方法" class="headerlink" title="Getters使用方法"></a>Getters使用方法</h3><code>Getters</code>中的方法有两个默认参数</li><li><code>state</code> 当前<code>vuex</code>对象中的状态对象</li><li><code>getters</code> 当前<code>getters</code>对象，用于将<code>getters</code>下的其他<code>getter</code>拿来用<br>定义<code>Getter</code>：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">getters:&#123;</span><br><span class="line">    name1(state) &#123;</span><br><span class="line">        <span class="keyword">return</span> state.name</span><br><span class="line">    &#125;,</span><br><span class="line">    name2(state, getters) &#123;</span><br><span class="line">        <span class="keyword">return</span> getters.name1 + state.name</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="方法一-2"><a href="#方法一-2" class="headerlink" title="方法一"></a>方法一</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$store.getters.名称</span><br></pre></td></tr></table></figure><h4 id="方法二-2"><a href="#方法二-2" class="headerlink" title="方法二"></a>方法二</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从vuex中按需导入mapGetters</span></span><br><span class="line"><span class="keyword">import</span> &#123; mapGetters &#125; <span class="keyword">from</span> <span class="string">'vuex'</span></span><br></pre></td></tr></table></figure><p>通过导入的<code>mapGetters</code>函数，将当前函数需要的全局数据，映射为当前组件的<code>computed</code>计算属性：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  ...mapGetters([<span class="string">'name1'</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;用了好久&lt;code&gt;vuex&lt;/code&gt;没有记录过，重新再学一遍并做一下笔记。&lt;/p&gt;
    
    </summary>
    
      <category term="vuex" scheme="http://chrischen0405.github.io/categories/vuex/"/>
    
    
      <category term="Vue" scheme="http://chrischen0405.github.io/tags/Vue/"/>
    
      <category term="vuex" scheme="http://chrischen0405.github.io/tags/vuex/"/>
    
      <category term="学习" scheme="http://chrischen0405.github.io/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>uniapp image标签base64不显示图片的问题</title>
    <link href="http://chrischen0405.github.io/2021/03/26/post20210326/"/>
    <id>http://chrischen0405.github.io/2021/03/26/post20210326/</id>
    <published>2021-03-26T08:29:04.000Z</published>
    <updated>2022-09-22T09:32:33.168Z</updated>
    
    <content type="html"><![CDATA[<h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><p>如题，在uniapp中使用<code>image</code>标签，<code>imgUrl</code>是后端返回的一段<code>base64</code>格式的图片：</p><a id="more"></a><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">image</span> <span class="attr">:src</span>=<span class="string">'imgUrl'</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这样可能会出现图片无法显示的问题，但是标签的<code>src</code>里是有值的，打开调试看到图片的透明度变成了0：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">uni-image</span>&gt;<span class="selector-tag">img</span> &#123;</span><br><span class="line"><span class="attribute">display</span>: block;</span><br><span class="line"><span class="attribute">position</span>: absolute; </span><br><span class="line"><span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">opacity</span>: <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="产生原因"><a href="#产生原因" class="headerlink" title="产生原因"></a>产生原因</h3><p>这是因为<code>base64</code>字符串太长，在传输过程中加入回车导致</p><h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><p>把<code>base64</code>中的换行符替换掉就好了：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">image</span> <span class="attr">:src</span>=<span class="string">'imgUrl.replace(/[\r\n]/g, ")'</span>&gt;</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;问题描述&quot;&gt;&lt;a href=&quot;#问题描述&quot; class=&quot;headerlink&quot; title=&quot;问题描述&quot;&gt;&lt;/a&gt;问题描述&lt;/h3&gt;&lt;p&gt;如题，在uniapp中使用&lt;code&gt;image&lt;/code&gt;标签，&lt;code&gt;imgUrl&lt;/code&gt;是后端返回的一段&lt;code&gt;base64&lt;/code&gt;格式的图片：&lt;/p&gt;
    
    </summary>
    
      <category term="uni-app" scheme="http://chrischen0405.github.io/categories/uni-app/"/>
    
    
      <category term="报错" scheme="http://chrischen0405.github.io/tags/%E6%8A%A5%E9%94%99/"/>
    
      <category term="uni-app" scheme="http://chrischen0405.github.io/tags/uni-app/"/>
    
      <category term="image" scheme="http://chrischen0405.github.io/tags/image/"/>
    
      <category term="base64" scheme="http://chrischen0405.github.io/tags/base64/"/>
    
  </entry>
  
  <entry>
    <title>yarn之后报node-sass错误</title>
    <link href="http://chrischen0405.github.io/2020/02/17/post20200217/"/>
    <id>http://chrischen0405.github.io/2020/02/17/post20200217/</id>
    <published>2020-02-17T09:14:14.000Z</published>
    <updated>2022-09-22T07:47:58.249Z</updated>
    
    <content type="html"><![CDATA[<p>今天项目<code>yarn</code>以后报了以下错误：<br><a id="more"></a><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">error D:\workproject\wxapp-liuliangphone\node_modules\node-sass: Command failed.</span><br><span class="line">Exit code: 1</span><br><span class="line">Command: node scripts/build.js</span><br><span class="line">Arguments:</span><br><span class="line">Directory: D:\workproject\wxapp-liuliangphone\node_modules\node-sass</span><br><span class="line">Output:</span><br><span class="line">Building: D:\nodejs\node.exe D:\workproject\wxapp-liuliangphone\node_modules\node-gyp\bin\node-gyp.js rebuild --verbose --libsass_ext= --libsa</span><br><span class="line">ss_cflags= --libsass_ldflags= --libsass_library=</span><br><span class="line">gyp info it worked if it ends with ok</span><br><span class="line">gyp verb cli [ 'D:\\nodejs\\node.exe',</span><br><span class="line">gyp verb cli   'D:\\workproject\\wxapp-liuliangphone\\node_modules\\node-gyp\\bin\\node-gyp.js',</span><br><span class="line">gyp verb cli   'rebuild',</span><br><span class="line">gyp verb cli   '--verbose',</span><br><span class="line">gyp verb cli   '--libsass_ext=',</span><br><span class="line">gyp verb cli   '--libsass_cflags=',</span><br><span class="line">gyp verb cli   '--libsass_ldflags=',</span><br><span class="line">gyp verb cli   '--libsass_library=' ]</span><br><span class="line">gyp info using node-gyp@3.8.0</span><br><span class="line">gyp info using node@8.6.0 | win32 | x64</span><br><span class="line">gyp verb command rebuild []</span><br><span class="line">gyp verb command clean []</span><br><span class="line">gyp verb clean removing "build" directory</span><br><span class="line">gyp verb command configure []</span><br><span class="line">gyp verb download using dist-url https://npm.taobao.org/dist</span><br><span class="line">gyp verb check python checking for Python executable "python2" in the PATH</span><br><span class="line">gyp verb `which` failed Error: not found: python2</span><br><span class="line">gyp verb `which` failed     at getNotFoundError (D:\workproject\wxapp-liuliangphone\node_modules\which\which.js:13:12)</span><br><span class="line">gyp verb `which` failed     at F (D:\workproject\wxapp-liuliangphone\node_modules\which\which.js:68:19)</span><br><span class="line">gyp verb `which` failed     at E (D:\workproject\wxapp-liuliangphone\node_modules\which\which.js:80:29)</span><br><span class="line">gyp verb `which` failed     at D:\workproject\wxapp-liuliangphone\node_modules\which\which.js:89:16</span><br><span class="line">gyp verb `which` failed     at D:\workproject\wxapp-liuliangphone\node_modules\isexe\index.js:42:5</span><br><span class="line">gyp verb `which` failed     at D:\workproject\wxapp-liuliangphone\node_modules\isexe\windows.js:36:5</span><br><span class="line">gyp verb `which` failed     at FSReqWrap.oncomplete (fs.js:153:21)</span><br><span class="line">gyp verb `which` failed  python2 &#123; Error: not found: python2</span><br><span class="line">gyp verb `which` failed     at getNotFoundError (D:\workproject\wxapp-liuliangphone\node_modules\which\which.js:13:12)</span><br><span class="line">gyp verb `which` failed     at F (D:\workproject\wxapp-liuliangphone\node_modules\which\which.js:68:19)</span><br><span class="line">gyp verb `which` failed     at E (D:\workproject\wxapp-liuliangphone\node_modules\which\which.js:80:29)</span><br><span class="line">gyp verb `which` failed     at D:\workproject\wxapp-liuliangphone\node_modules\which\which.js:89:16</span><br><span class="line">gyp verb `which` failed     at D:\workproject\wxapp-liuliangphone\node_modules\isexe\index.js:42:5</span><br><span class="line">gyp verb `which` failed     at D:\workproject\wxapp-liuliangphone\node_modules\isexe\windows.js:36:5</span><br><span class="line">gyp verb `which` failed     at FSReqWrap.oncomplete (fs.js:153:21)</span><br><span class="line">gyp verb `which` failed   stack: 'Error: not found: python2\n    at getNotFoundError (D:\\workproject\\wxapp-liuliangphone\\node_modules\\whic</span><br><span class="line">h\\which.js:13:12)\n    at F (D:\\workproject\\wxapp-liuliangphone\\node_modules\\which\\which.js:68:19)\n    at E (D:\\workproject\\wxapp-liu</span><br><span class="line">liangphone\\node_modules\\which\\which.js:80:29)\n    at D:\\workproject\\wxapp-liuliangphone\\node_modules\\which\\which.js:89:16\n    at D:\</span><br><span class="line">\workproject\\wxapp-liuliangphone\\node_modules\\isexe\\index.js:42:5\n    at D:\\workproject\\wxapp-liuliangphone\\node_modules\\isexe\\windo</span><br><span class="line">ws.js:36:5\n    at FSReqWrap.oncomplete (fs.js:153:21)',</span><br><span class="line">gyp verb `which` failed   code: 'ENOENT' &#125;</span><br><span class="line">gyp verb check python checking for Python executable "python" in the PATH</span><br><span class="line">gyp verb `which` failed Error: not found: python</span><br><span class="line">gyp verb `which` failed     at getNotFoundError (D:\workproject\wxapp-liuliangphone\node_modules\which\which.js:13:12)</span><br><span class="line">gyp verb `which` failed     at F (D:\workproject\wxapp-liuliangphone\node_modules\which\which.js:68:19)</span><br><span class="line">gyp verb `which` failed     at E (D:\workproject\wxapp-liuliangphone\node_modules\which\which.js:80:29)</span><br><span class="line">gyp verb `which` failed     at D:\workproject\wxapp-liuliangphone\node_modules\which\which.js:89:16</span><br><span class="line">gyp verb `which` failed     at D:\workproject\wxapp-liuliangphone\node_modules\isexe\index.js:42:5</span><br><span class="line">gyp verb `which` failed     at D:\workproject\wxapp-liuliangphone\node_modules\isexe\windows.js:36:5</span><br><span class="line">gyp verb `which` failed     at FSReqWrap.oncomplete (fs.js:153:21)</span><br><span class="line">gyp verb `which` failed  python &#123; Error: not found: python</span><br><span class="line">gyp verb `which` failed     at getNotFoundError (D:\workproject\wxapp-liuliangphone\node_modules\which\which.js:13:12)</span><br><span class="line">gyp verb `which` failed     at F (D:\workproject\wxapp-liuliangphone\node_modules\which\which.js:68:19)</span><br><span class="line">gyp verb `which` failed     at E (D:\workproject\wxapp-liuliangphone\node_modules\which\which.js:80:29)</span><br><span class="line">gyp verb `which` failed     at D:\workproject\wxapp-liuliangphone\node_modules\which\which.js:89:16</span><br><span class="line">gyp verb `which` failed     at D:\workproject\wxapp-liuliangphone\node_modules\isexe\index.js:42:5</span><br><span class="line">gyp verb `which` failed     at D:\workproject\wxapp-liuliangphone\node_modules\isexe\windows.js:36:5</span><br><span class="line">gyp verb `which` failed     at FSReqWrap.oncomplete (fs.js:153:21)</span><br><span class="line">gyp verb `which` failed   stack: 'Error: not found: python\n    at getNotFoundError (D:\\workproject\\wxapp-liuliangphone\\node_modules\\which</span><br><span class="line">\\which.js:13:12)\n    at F (D:\\workproject\\wxapp-liuliangphone\\node_modules\\which\\which.js:68:19)\n    at E (D:\\workproject\\wxapp-liul</span><br><span class="line">iangphone\\node_modules\\which\\which.js:80:29)\n    at D:\\workproject\\wxapp-liuliangphone\\node_modules\\which\\which.js:89:16\n    at D:\\</span><br><span class="line">workproject\\wxapp-liuliangphone\\node_modules\\isexe\\index.js:42:5\n    at D:\\workproject\\wxapp-liuliangphone\\node_modules\\isexe\\window</span><br><span class="line">s.js:36:5\n    at FSReqWrap.oncomplete (fs.js:153:21)',</span><br><span class="line">gyp verb `which` failed   code: 'ENOENT' &#125;</span><br><span class="line">gyp verb could not find "python". checking python launcher</span><br><span class="line">gyp verb could not find "python". guessing location</span><br><span class="line">gyp verb ensuring that file exists: C:\Python27\python.exe</span><br><span class="line">gyp ERR! configure error</span><br><span class="line">gyp ERR! stack Error: Can't find Python executable "python", you can set the PYTHON env variable.</span><br><span class="line">gyp ERR! stack     at PythonFinder.failNoPython (D:\workproject\wxapp-liuliangphone\node_modules\node-gyp\lib\configure.js:484:19)</span><br><span class="line">gyp ERR! stack     at PythonFinder.&lt;anonymous&gt; (D:\workproject\wxapp-liuliangphone\node_modules\node-gyp\lib\configure.js:509:16)</span><br><span class="line">gyp ERR! stack     at callback (D:\workproject\wxapp-liuliangphone\node_modules\graceful-fs\polyfills.js:295:20)</span><br><span class="line">gyp ERR! stack     at FSReqWrap.oncomplete (fs.js:153:21)</span><br><span class="line">gyp ERR! System Windows_NT 6.3.9600</span><br><span class="line">gyp ERR! command "D:\\nodejs\\node.exe" "D:\\workproject\\wxapp-liuliangphone\\node_modules\\node-gyp\\bin\\node-gyp.js" "rebuild" "--verbose"</span><br><span class="line"> "--libsass_ext=" "--libsass_cflags=" "--libsass_ldflags=" "--libsass_library="</span><br><span class="line">gyp ERR! cwd D:\workproject\wxapp-liuliangphone\node_modules\node-sass</span><br><span class="line">gyp ERR! node -v v8.6.0</span><br><span class="line">gyp ERR! node-gyp -v v3.8.0</span><br><span class="line">gyp ERR! not ok</span><br></pre></td></tr></table></figure></p><p>网上找了一圈解决办法，大多是重装<code>node-sass</code>，大家可以试一下，但是我并没有用，依旧是<code>ERR!</code>，因为产生的原因是因为windows缺少编译的运行环境所以无法安装<code>node-sass</code>导致的错误，只需要：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn global add node-gyp  windows-build-tools</span><br></pre></td></tr></table></figure></p><p>安装完<code>windows-build-tools</code>以后重新<code>yarn</code>就可以了，亲测有效</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;今天项目&lt;code&gt;yarn&lt;/code&gt;以后报了以下错误：&lt;br&gt;
    
    </summary>
    
      <category term="踩坑" scheme="http://chrischen0405.github.io/categories/%E8%B8%A9%E5%9D%91/"/>
    
    
      <category term="报错" scheme="http://chrischen0405.github.io/tags/%E6%8A%A5%E9%94%99/"/>
    
      <category term="yarn" scheme="http://chrischen0405.github.io/tags/yarn/"/>
    
      <category term="npm" scheme="http://chrischen0405.github.io/tags/npm/"/>
    
      <category term="node" scheme="http://chrischen0405.github.io/tags/node/"/>
    
  </entry>
  
  <entry>
    <title>mpvue动画</title>
    <link href="http://chrischen0405.github.io/2020/01/08/post20200217-3/"/>
    <id>http://chrischen0405.github.io/2020/01/08/post20200217-3/</id>
    <published>2020-01-08T09:48:47.000Z</published>
    <updated>2022-09-22T07:47:58.248Z</updated>
    
    <content type="html"><![CDATA[<p>记录一下用mpvue开发微信小程序遇到的问题<br>背景是小程序上需要写一个简单的循环动画，试了几种方法，留下了一堆坑，之后如果有空或者又遇到这个问题了再填吧（跑）<br><a id="more"></a></p><h2 id="1-wx-createAnimation"><a href="#1-wx-createAnimation" class="headerlink" title="1.wx.createAnimation"></a>1.wx.createAnimation</h2><p>先调用<code>createAnimation</code> API创建一个动画实例animation。调用实例的方法来描述动画。最后通过动画实例的<code>export</code>方法导出动画数据传递给组件的 animation 属性。<a href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/animation/wx.createAnimation.html" target="_blank" rel="noopener">官方文档</a>的例子如下：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">animation</span>=<span class="string">"&#123;&#123;animationData&#125;&#125;"</span> <span class="attr">style</span>=<span class="string">"background:red;height:100rpx;width:100rpx"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">      animationData: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  onShow: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> animation = wx.createAnimation(&#123;</span><br><span class="line">        duration: <span class="number">1000</span>,</span><br><span class="line">        timingFunction: <span class="string">'ease'</span>,</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">this</span>.animation = animation</span><br><span class="line"></span><br><span class="line">      animation.scale(<span class="number">2</span>,<span class="number">2</span>).rotate(<span class="number">45</span>).step()</span><br><span class="line"></span><br><span class="line">      <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">        animationData:animation.export()</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        animation.translate(<span class="number">30</span>).step()</span><br><span class="line">        <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">          animationData:animation.export()</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;.bind(<span class="keyword">this</span>), <span class="number">1000</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>mpvue和小程序原生的写法稍微有点不同：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:animation</span>=<span class="string">"animationData"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">      animationData: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  onShow () &#123;</span><br><span class="line">    <span class="keyword">let</span> animation = mpvue.createAnimation(&#123;</span><br><span class="line">        duration: <span class="number">1000</span>,</span><br><span class="line">        timingFunction: <span class="string">'ease'</span>,</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">    animation.scale(<span class="number">2</span>,<span class="number">2</span>).rotate(<span class="number">45</span>).step()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.animationData = animation.export()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>大体上都是相同的，不一样的地方在于mpvue没有<code>this.animation</code>，因为原生的小程序this指的是最外面的Page，而mpvue中this指的是外层vue对象，两者虽然看起来一样，但是指向不同，编译以后会报错（暂时没有解决mpvue中不能使用微信小程序的this.animation的问题，这个坑，之后有空再填orz），但是可以直接把创建的动画实例<code>animation</code>赋值给已经绑定在动画节点上的<code>this.animationData</code>，就可以该元素的动画效果了，我暂时没有搞明白为什么原生小程序还需要给<code>this.animation</code>赋值一个动画实例，明明可以直接给绑定在动画节点上的变量赋值实现动画效果（留个坑）</p><h2 id="2-关键帧动画"><a href="#2-关键帧动画" class="headerlink" title="2.关键帧动画"></a>2.关键帧动画</h2><p>从小程序基础库2.9.0开始支持一种更友好的动画创建方式，用于代替旧的<code>wx.createAnimation</code>。它具有更好的性能和更可控的接口。在页面或自定义组件中，当需要进行关键帧动画时，可以使用 <code>this.animate</code> 接口：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.animate(selector, keyframes, duration, callback)</span><br></pre></td></tr></table></figure></p><p>参数列表如下：</p><ul><li>selector  选择器</li><li>keyframes  关键帧信息</li><li>duration  动画持续时长（毫秒为单位）</li><li>callback  动画完成后的回调函数<br>之前已经说了，在mpvue里面的<code>this</code>和原生小程序中的<code>this</code>不同，所以就不能直接使用<code>this.animate</code>接口（暂时不知道怎么在mpvue中直接使用<code>this.animate</code>接口，留个坑）<br>举个在原生小程序里使用的例子：<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"container"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">      animationData: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  onShow: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.animate(<span class="string">'#container'</span>, [</span><br><span class="line">      &#123; <span class="attr">opacity</span>: <span class="number">1.0</span>, <span class="attr">rotate</span>: <span class="number">0</span>, <span class="attr">backgroundColor</span>: <span class="string">'#FF0000'</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">opacity</span>: <span class="number">0.5</span>, <span class="attr">rotate</span>: <span class="number">45</span>, <span class="attr">backgroundColor</span>: <span class="string">'#00FF00'</span>&#125;,</span><br><span class="line">      &#123; <span class="attr">opacity</span>: <span class="number">0.0</span>, <span class="attr">rotate</span>: <span class="number">90</span>, <span class="attr">backgroundColor</span>: <span class="string">'#FF0000'</span> &#125;,</span><br><span class="line">      ], <span class="number">5000</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.clearAnimation(<span class="string">'#container'</span>, &#123; <span class="attr">opacity</span>: <span class="literal">true</span>, <span class="attr">rotate</span>: <span class="literal">true</span> &#125;, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">"清除了#container上的opacity和rotate属性"</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;.bind(<span class="keyword">this</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>调用<code>animate</code> API 后会在节点上新增一些样式属性覆盖掉原有的对应样式。如果需要清除这些样式，可在该节点上的动画全部执行完毕后，在回调函数中使用<code>this.clearAnimation</code>清除这些属性。</p><h2 id="3-css3动画"><a href="#3-css3动画" class="headerlink" title="3.css3动画"></a>3.css3动画</h2><p>看了一圈发现原生小程序的动画对mpvue不是很友好，而且只能执行一次，要想循环还需要写定时器，所以还可以直接选择用css3动画来写：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: animation <span class="number">1s</span>;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">keyframes</span> animation &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;<span class="attribute">background</span>: red;&#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;<span class="attribute">background</span>: yellow;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>OK，一下子就搞定了</p><p>看了看文档，写完以后还是对小程序动画一知半解，留下了不少坑没有解决，希望之后会把这些坑补上orz。如果上面有什么写的不对的地方或者想法可以指正</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;记录一下用mpvue开发微信小程序遇到的问题&lt;br&gt;背景是小程序上需要写一个简单的循环动画，试了几种方法，留下了一堆坑，之后如果有空或者又遇到这个问题了再填吧（跑）&lt;br&gt;
    
    </summary>
    
      <category term="个人整理" scheme="http://chrischen0405.github.io/categories/%E4%B8%AA%E4%BA%BA%E6%95%B4%E7%90%86/"/>
    
    
      <category term="mpvue" scheme="http://chrischen0405.github.io/tags/mpvue/"/>
    
      <category term="动画" scheme="http://chrischen0405.github.io/tags/%E5%8A%A8%E7%94%BB/"/>
    
      <category term="微信小程序" scheme="http://chrischen0405.github.io/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
      <category term="animation" scheme="http://chrischen0405.github.io/tags/animation/"/>
    
      <category term="小程序" scheme="http://chrischen0405.github.io/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
</feed>
